var InstantClick=function(o,d){function f(c){var a=c.indexOf("#");return 0>a?c:c.substr(0,a)}function c(b){for(;b&&"A"!=b.nodeName;)b=b.parentNode;return b}function e(c){var e=d.protocol+"//"+d.host;if(!(e=c.target||c.hasAttribute("download")||0!=c.href.indexOf(e+"/")||-1<c.href.indexOf("#")&&f(c.href)==M)){if(V){a:{do{if(!c.hasAttribute)break;if(c.hasAttribute("data-no-instant"))break;if(c.hasAttribute("data-instant")){c=!0;break a}}while(c=c.parentNode);c=!1}c=!c}else a:{do{if(!c.hasAttribute)break;if(c.hasAttribute("data-instant"))break;if(c.hasAttribute("data-no-instant")){c=!0;break a}}while(c=c.parentNode);c=!1}e=c}return!e}function n(h,a,b,k){for(var l=!1,m=0;m<E[h].length;m++)if("receive"==h){var n=E[h][m](a,b,k);n&&("body"in n&&(b=n.body),"title"in n&&(k=n.title),l=n)}else E[h][m](a,b,k);return l}function b(d,e,h,c){if(o.documentElement.replaceChild(e,o.body),h){if(history.pushState(null,null,h),e=h.indexOf("#"),e=-1<e&&o.getElementById(h.substr(e+1)),c=0,e)for(;e.offsetParent;)c+=e.offsetTop,e=e.offsetParent;scrollTo(0,c),M=f(h)}else scrollTo(0,c);o.title=I&&o.title==d?d+String.fromCharCode(160):d,K(),B.done(),n("change",!1),d=o.createEvent("HTMLEvents"),d.initEvent("instantclick:newpage",!0,!0),dispatchEvent(d)}function s(b){T>+new Date-500||(b=c(b.target))&&e(b)&&L(b.href)}function t(b){T>+new Date-500||(b=c(b.target))&&e(b)&&(b.addEventListener("mouseout",g),X?(N=b.href,P=setTimeout(L,X)):L(b.href))}function w(b){T=+new Date,(b=c(b.target))&&e(b)&&(W?b.removeEventListener("mousedown",s):b.removeEventListener("mouseover",t),L(b.href))}function z(d){var a=c(d.target);!a||!e(a)||1<d.which||d.metaKey||d.ctrlKey||(d.preventDefault(),x(a.href))}function g(){P?(clearTimeout(P),P=!1):aa&&!ba&&(U.abort(),ba=aa=!1)}function A(){if(!(4>U.readyState)&&0!=U.status){if(_.ready=+new Date-_.start,U.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var d=o.implementation.createHTMLDocument("");d.documentElement.innerHTML=U.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),Y=d.title,$=d.body;var k=n("receive",h,$,Y);k&&("body"in k&&($=k.body),"title"in k&&(Y=k.title)),k=f(h),Q[k]={body:$,title:Y,scrollY:k in Q?Q[k].scrollY:0};for(var l,d=d.head.children,k=0,m=d.length-1;0<=m;m--)if(l=d[m],l.hasAttribute("data-instant-track")){l=l.getAttribute("href")||l.getAttribute("src")||l.innerHTML;for(var p=ca.length-1;0<=p;p--)ca[p]==l&&k++}k!=ca.length&&(Z=!0)}else Z=!0;ba&&(ba=!1,x(h))}}function K(d){if(o.body.addEventListener("touchstart",w,!0),W?o.body.addEventListener("mousedown",s,!0):o.body.addEventListener("mouseover",t,!0),o.body.addEventListener("click",z,!0),!d){d=o.body.getElementsByTagName("script");var f,h,k,l;for(i=0,j=d.length;i<j;i++)f=d[i],f.hasAttribute("data-no-instant")||(h=o.createElement("script"),f.src&&(h.src=f.src),f.innerHTML&&(h.innerHTML=f.innerHTML),k=f.parentNode,l=f.nextSibling,k.removeChild(f),k.insertBefore(h,l))}}function L(b){!W&&"display"in _&&100>+new Date-(_.start+_.display)||(P&&(clearTimeout(P),P=!1),b||(b=N),aa&&(b==h||ba))||(aa=!0,ba=!1,h=b,Z=$=!1,_={start:+new Date},n("fetch"),U.open("GET",b),U.send())}function x(c){"display"in _||(_.display=+new Date-_.start),P||!aa?P&&h&&h!=c?d.href=c:(L(c),B.start(0,!0),n("wait"),ba=!0):ba?d.href=c:Z?d.href=h:$?(Q[M].scrollY=pageYOffset,ba=aa=!1,b(Y,$,h)):(B.start(0,!0),n("wait"),ba=!0)}var M,N,P,T,U,V,W,X,a=navigator.userAgent,I=-1<a.indexOf(" CriOS/"),S="createTouch"in o,Q={},h=!1,Y=!1,Z=!1,$=!1,_={},aa=!1,ba=!1,ca=[],E={fetch:[],receive:[],wait:[],change:[]},B=function(){function d(d,a){r=d,o.getElementById(g.id)&&o.body.removeChild(g),g.style.opacity="1",o.getElementById(g.id)&&o.body.removeChild(g),c(),a&&setTimeout(p,0),clearTimeout(s),s=setTimeout(b,500)}function p(){r=10,c()}function b(){r+=1+2*Math.random(),98<=r?r=98:s=setTimeout(b,500),c()}function c(){m.style[q]="translate("+r+"%)",o.getElementById(g.id)||o.body.appendChild(g)}function a(){o.getElementById(g.id)?(clearTimeout(s),r=100,c(),g.style.opacity="0"):(d(100==r?0:r),setTimeout(a,0))}function e(){g.style.left=pageXOffset+"px",g.style.width=innerWidth+"px",g.style.top=pageYOffset+"px";var b="orientation"in window&&90==Math.abs(orientation);g.style[q]="scaleY("+2*(innerWidth/screen[b?"height":"width"])+")"}var g,m,q,r,s;return{init:function(){g=o.createElement("div"),g.id="instantclick",m=o.createElement("div"),m.id="instantclick-bar",m.className="instantclick-bar",g.appendChild(m);var d=["Webkit","Moz","O"];if(q="transform",!(q in m.style))for(var f=0;3>f;f++)d[f]+"Transform"in m.style&&(q=d[f]+"Transform");var h="transition";if(!(h in m.style))for(f=0;3>f;f++)d[f]+"Transition"in m.style&&(h="-"+d[f].toLowerCase()+"-"+h);d=o.createElement("style"),d.innerHTML="#instantclick{position:"+(S?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+h+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+h+":all .25s}",o.head.appendChild(d),S&&(e(),addEventListener("resize",e),addEventListener("scroll",e))},start:d,done:a}}(),C="pushState"in history&&(!a.match("Android")||a.match("Chrome/"))&&"file:"!=d.protocol;return{supported:C,init:function(){if(!M)if(C){for(var e,g=arguments.length-1;0<=g;g--)e=arguments[g],!0===e?V=!0:"mousedown"==e?W=!0:"number"==typeof e&&(X=e);M=f(d.href),Q[M]={body:o.body,title:o.title,scrollY:pageYOffset};for(var h,e=o.head.children,g=e.length-1;0<=g;g--)h=e[g],h.hasAttribute("data-instant-track")&&(h=h.getAttribute("href")||h.getAttribute("src")||h.innerHTML,ca.push(h));U=new XMLHttpRequest,U.addEventListener("readystatechange",A),K(!0),B.init(),n("change",!0),addEventListener("popstate",function(){var c=f(d.href);c!=M&&(c in Q?(Q[M].scrollY=pageYOffset,M=c,b(Q[c].title,Q[c].body,!1,Q[c].scrollY)):d.href=d.href)})}else n("change",!0)},on:function(c,a){E[c].push(a)}}}(document,location);