
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Nitrokey HSM/SmartCard-HSM and Raspberry Pi web cluster - Raymii.org</title>
        <style> *, ::before, ::after {background-repeat: no-repeat;-webkit-box-sizing: border-box;box-sizing: border-box;}::before, ::after {text-decoration: inherit;vertical-align: inherit;}html {cursor: default;font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";line-height: 1.15;-moz-tab-size: 4;-o-tab-size: 4;tab-size: 4;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;word-break: break-word;}body {background-color: white;margin: 0;}h1 {font-size: 2em;margin: 0.67em 0;}hr {height: 0;overflow: visible;}main {display: block;}nav ol, nav ul {list-style: none;}pre {font-family: Roboto Mono, Menlo, Consolas, Ubuntu Monospace, Noto Mono, Oxygen Mono, Liberation Mono, monospace;font-size: 1em;}a {background-color: transparent;}abbr[title] {text-decoration: underline;-webkit-text-decoration: underline dotted;text-decoration: underline dotted;}b, strong {font-weight: bolder;}code, kbd, samp {font-family: Menlo, Consolas, Roboto Mono, Ubuntu Monospace, Noto Mono, Oxygen Mono, Liberation Mono, monospace;font-size: 1em;}small {font-size: 80%;}::-moz-selection {background-color: #b3d4fc;color: #000;text-shadow: none;}::selection {background-color: #b3d4fc;color: #000;text-shadow: none;}audio, canvas, iframe, img, svg, video {vertical-align: middle;}audio, video {display: inline-block;}audio:not([controls]) {display: none;height: 0;}img {border-style: none;}svg:not([fill]) {fill: currentColor;}svg:not(:root) {overflow: hidden;}table {border-collapse: collapse;}button, input, select, textarea {font-family: inherit;font-size: inherit;line-height: inherit;}button, input, select {margin: 0;}button {overflow: visible;text-transform: none;}button, [type="button"], [type="reset"], [type="submit"] {-webkit-appearance: button;}fieldset {padding: 0.35em 0.75em 0.625em;}input {overflow: visible;}legend {color: inherit;display: table;max-width: 100%;white-space: normal;}progress {display: inline-block;vertical-align: baseline;}select {text-transform: none;}textarea {margin: 0;overflow: auto;resize: vertical;}[type="checkbox"], [type="radio"] {padding: 0;}[type="search"] {-webkit-appearance: textfield;outline-offset: -2px;}::-webkit-inner-spin-button, ::-webkit-outer-spin-button {height: auto;}::-webkit-input-placeholder {color: inherit;opacity: 0.54;}::-webkit-search-decoration {-webkit-appearance: none;}::-webkit-file-upload-button {-webkit-appearance: button;font: inherit;}::-moz-focus-inner {border-style: none;padding: 0;}:-moz-focusring {outline: 1px dotted ButtonText;}details {display: block;}dialog {background-color: white;border: solid;color: black;display: block;height: -moz-fit-content;height: -webkit-fit-content;height: fit-content;left: 0;margin: auto;padding: 1em;position: absolute;right: 0;width: -moz-fit-content;width: -webkit-fit-content;width: fit-content;}dialog:not([open]) {display: none;}summary {display: list-item;}canvas {display: inline-block;}template {display: none;}a, area, button, input, label, select, summary, textarea, [tabindex] {-ms-touch-action: manipulation;touch-action: manipulation;}[hidden] {display: none;}[aria-busy="true"] {cursor: progress;}[aria-controls] {cursor: pointer;}[aria-disabled="true"], [disabled] {cursor: not-allowed;}[aria-hidden="false"][hidden]:not(:focus) {clip: rect(0, 0, 0, 0);display: inherit;position: absolute;}main, header, footer, article, section, aside, details, summary {margin: 0 auto;margin-bottom: 16px;width: 100%;}main {display: block;margin: 0 auto;max-width: 1000px;padding: 0 16px 16px;}footer {border-top: 1px solid rgba(0, 0, 0, 0.12);padding: 16px 0;text-align: left;}footer p {margin-bottom: 0;}hr {border: 0;border-top: 1px solid rgba(0, 0, 0, 0.12);display: block;margin-top: 16px;margin-bottom: 16px;width: 100%;-webkit-box-sizing: content-box;box-sizing: content-box;height: 0;overflow: visible;}img {height: auto;max-width: 100%;vertical-align: baseline;}@media screen and (max-width: 400px) {article, section, aside {clear: both;display: block;max-width: 100%;}img {margin-right: 16px;}}embed, iframe, video {border: 0;}body {color: rgba(0, 0, 0, 0.8);font-family: "Ubuntu", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.5;}p {margin: 0;margin-bottom: 16px;}h1, h2, h3, h4, h5, h6 {color: inherit;font-family: inherit;line-height: 1.2;font-weight: 500;}h1 {font-size: 40px;margin: 20px 0 16px;}h2 {font-size: 32px;margin: 20px 0 16px;}h3 {color: #75cc00;font-size: 28px;margin: 16px 0 4px;}h4 {color: #75cc00;font-size: 24px;margin: 16px 0 4px;}h5 {color: #75cc00;font-size: 20px;margin: 16px 0 4px;}h6 {color: #75cc00;font-size: 16px;margin: 16px 0 4px;}small {color: rgba(0, 0, 0, 0.54);vertical-align: bottom;}pre {background: #f7f7f9;color: rgba(0, 0, 0, 0.8);display: block;font-family: "Roboto Mono", Menlo, Monaco, Consolas, "Courier New", monospace;font-size: 16px;margin: 16px 0;padding: 16px;white-space: pre-wrap;overflow-wrap: break-word;}code {background: #f7f7f9;color: rgba(0, 0, 0, 0.8);font-family: "Roboto Mono", Menlo, Monaco, Consolas, "Courier New", monospace;font-size: 16px;line-height: inherit;margin: 0;vertical-align: baseline;word-break: break-all;word-wrap: break-word;}a {color: #75cc00;text-decoration: none;background-color: transparent;}a:hover, a:focus {color: #0062cc;font-weight: bolder;text-decoration: underline;}dl {margin-bottom: 16px;}dd {margin-left: 40px;}ul, ol {margin-bottom: 8px;padding-left: 40px;vertical-align: baseline;}blockquote {border-left: 2px solid rgba(0, 0, 0, 0.8);font-family: Georgia, Times, "Times New Roman", serif;font-style: italic;margin: 16px 0;padding-left: 16px;}figcaption {font-family: Georgia, Times, "Times New Roman", serif;}u {text-decoration: underline;}s {text-decoration: line-through;}sup {font-size: 14px;vertical-align: super;}sub {font-size: 14px;vertical-align: sub;}mark {background: #ffeb3b;}input[type="text"], input[type="password"], input[type="email"], input[type="url"], input[type="date"], input[type="month"], input[type="time"], input[type="datetime"], input[type="datetime-local"], input[type="week"], input[type="number"], input[type="search"], input[type="tel"], select, textarea {background: #fff;background-clip: padding-box;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;color: rgba(0, 0, 0, 0.8);display: block;width: 100%;padding: 8px 16px;line-height: 1.5;-webkit-transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}input[type="color"] {background: #fff;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;display: inline-block;vertical-align: middle;}input:not([type]) {-webkit-appearance: none;background: #fff;background-clip: padding-box;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;color: rgba(0, 0, 0, 0.8);display: block;width: 100%;padding: 8px 16px;line-height: 1.5;-webkit-transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;text-align: left;}input[type="text"]:focus, input[type="password"]:focus, input[type="email"]:focus, input[type="url"]:focus, input[type="date"]:focus, input[type="month"]:focus, input[type="time"]:focus, input[type="datetime"]:focus, input[type="datetime-local"]:focus, input[type="week"]:focus, input[type="number"]:focus, input[type="search"]:focus, input[type="tel"]:focus, input[type="color"]:focus, select:focus, textarea:focus {background-color: #fff;border-color: #80bdff;outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);}input:not([type]):focus {background-color: #fff;border-color: #80bdff;outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);}input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus {outline: 1px thin rgba(0, 0, 0, 0.12);}input[type="text"][disabled], input[type="password"][disabled], input[type="email"][disabled], input[type="url"][disabled], input[type="date"][disabled], input[type="month"][disabled], input[type="time"][disabled], input[type="datetime"][disabled], input[type="datetime-local"][disabled], input[type="week"][disabled], input[type="number"][disabled], input[type="search"][disabled], input[type="tel"][disabled], input[type="color"][disabled], select[disabled], textarea[disabled] {background-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);cursor: not-allowed;opacity: 1;}input:not([type])[disabled] {background-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);cursor: not-allowed;opacity: 1;}input[readonly], select[readonly], textarea[readonly] {border-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);}input:focus:invalid, textarea:focus:invalid, select:focus:invalid {border-color: #ea1c0d;color: #f44336;}input[type="file"]:focus:invalid:focus, input[type="radio"]:focus:invalid:focus, input[type="checkbox"]:focus:invalid:focus {outline-color: #f44336;}select {border: 1px solid rgba(0, 0, 0, 0.12);vertical-align: sub;}select:not([size]):not([multiple]) {height: -webkit-calc(2.25rem + 2px);height: calc(2.25rem + 2px);}select[multiple] {height: auto;}label {display: inline-block;line-height: 2;}fieldset {border: 0;margin: 0;padding: 8px 0;}legend {border-bottom: 1px solid rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.8);display: block;margin-bottom: 8px;padding: 8px 0;width: 100%;}textarea {overflow: auto;resize: vertical;}input[type=checkbox], input[type=radio] {-webkit-box-sizing: border-box;box-sizing: border-box;padding: 0;display: inline;}input[type=submit], input[type=reset], input[type=button], button {background-color: #75cc00;border: #75cc00;border-radius: 4px;color: #fff;padding: 8px 16px;display: inline-block;font-weight: 400;text-align: center;white-space: nowrap;vertical-align: middle;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;border: 1px solid transparent;font-size: 1rem;line-height: 1.5;-webkit-transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;}input[type=submit]::-moz-focus-inner, input[type=reset]::-moz-focus-inner, input[type=button]::-moz-focus-inner, button::-moz-focus-inner {padding: 0;}input[type=submit]:hover, input[type=reset]:hover, input[type=button]:hover, button:hover {background-color: #0069d9;border-color: #0062cc;color: #fff;}input[type=submit]:not(:disabled):active, input[type=reset]:not(:disabled):active, input[type=button]:not(:disabled):active, button:not(:disabled):active {background-color: #0062cc;border-color: #005cbf;color: #fff;}input[type=submit]:focus, input[type=reset]:focus, input[type=button]:focus, button:focus {outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);}input[type=submit]:disabled, input[type=reset]:disabled, input[type=button]:disabled, button:disabled {opacity: .65;cursor: not-allowed;background-color: #75cc00;border-color: #75cc00;color: #fff;}table {border-top: 1px solid rgba(0, 0, 0, 0.12);margin-bottom: 16px;}caption {padding: 8px 0;}thead th {border: 0;border-bottom: 2px solid rgba(0, 0, 0, 0.12);text-align: left;}tr {margin-bottom: 8px;}th, td {border-bottom: 1px solid rgba(0, 0, 0, 0.12);padding: 16px;white-space: nowrap;vertical-align: inherit;}tfoot tr {text-align: left;}tfoot td {color: rgba(0, 0, 0, 0.54);font-size: 8px;font-style: italic;padding: 16px 4px;}a.skip-main {left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-999;}a.skip-main:focus, a.skip-main:active {color: #fff;background-color:#000;left: auto;top: auto;width: 30%;height: auto;overflow:auto;margin: 10px 35%;padding:5px;border-radius: 15px;border:4px solid yellow;text-align:center;font-size:1.2em;z-index:999;}@font-face {font-family: 'Raleway';font-style: normal;font-weight: 600;src: url('/s/inc/css/raleway-v18-latin-600.eot');src: local(''), url('/s/inc/css/raleway-v18-latin-600.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/raleway-v18-latin-600.woff2') format('woff2'), url('/s/inc/css/raleway-v18-latin-600.woff') format('woff'), url('/s/inc/css/raleway-v18-latin-600.ttf') format('truetype'), url('/s/inc/css/raleway-v18-latin-600.svg#Raleway') format('svg');}@font-face {font-family: 'Raleway';font-style: italic;font-weight: 400;src: url('/s/inc/css/raleway-v18-latin-italic.eot');src: local(''), url('/s/inc/css/raleway-v18-latin-italic.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/raleway-v18-latin-italic.woff2') format('woff2'), url('/s/inc/css/raleway-v18-latin-italic.woff') format('woff'), url('/s/inc/css/raleway-v18-latin-italic.ttf') format('truetype'), url('/s/inc/css/raleway-v18-latin-italic.svg#Raleway') format('svg');}@font-face {font-family: 'Roboto Mono';font-style: normal;font-weight: 400;src: url('/s/inc/css/roboto-mono-v12-latin-regular.eot');src: local(''), url('/s/inc/css/roboto-mono-v12-latin-regular.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/roboto-mono-v12-latin-regular.woff2') format('woff2'), url('/s/inc/css/roboto-mono-v12-latin-regular.woff') format('woff'), url('/s/inc/css/roboto-mono-v12-latin-regular.ttf') format('truetype'), url('/s/inc/css/roboto-mono-v12-latin-regular.svg#RobotoMono') format('svg');}@font-face {font-family: 'Roboto Mono';font-style: normal;font-weight: 600;src: url('/s/inc/css/roboto-mono-v12-latin-600.eot');src: local(''), url('/s/inc/css/roboto-mono-v12-latin-600.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/roboto-mono-v12-latin-600.woff2') format('woff2'), url('/s/inc/css/roboto-mono-v12-latin-600.woff') format('woff'), url('/s/inc/css/roboto-mono-v12-latin-600.ttf') format('truetype'), url('/s/inc/css/roboto-mono-v12-latin-600.svg#RobotoMono') format('svg');}@font-face {font-family: 'Ubuntu';font-style: normal;font-weight: 400;src: url('/s/inc/css/ubuntu-v15-latin-regular.eot');src: local(''), url('/s/inc/css/ubuntu-v15-latin-regular.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/ubuntu-v15-latin-regular.woff2') format('woff2'), url('/s/inc/css/ubuntu-v15-latin-regular.woff') format('woff'), url('/s/inc/css/ubuntu-v15-latin-regular.ttf') format('truetype'), url('/s/inc/css/ubuntu-v15-latin-regular.svg#Ubuntu') format('svg');}@font-face {font-family:'Raleway2';font-style:normal;font-weight:normal;src:url('/s/inc/css/raleway.eot');src:local('Raleway2'),local('Raleway2'),url('/s/inc/css/raleway.ttf') }.headheader {font-family:"Raleway2"!important }.headheader a {color:#000;text-decoration:none }.headheader a:hover {color:#000;text-decoration:none!important }#toc ul {list-style: none;margin: 0;padding: 0;}#toc h3 {color:black;}</style>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
        <link rel="stylesheet" href="/s/inc/css/cookieconsent.css" media="print" onload="this.media='all'">
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org 
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAKCAYAAAD2Fg1xAAABgElEQVQ4jb3VP0iVYRTH8c9waXBokog7OYhTXChuF3GIi4hoiJA4REQIOTgGtoWTg6ODs0SYComIXCJEMhpKtD9guUU0ujRFS0PQ8DzC24v3Pq+3S9/pnMOP8/7Ocx6el/OziRN0JXTD+I2xhK4WdeNteGmbu8IgC3jQQlfCZ0zgINHzJabwoQP+ClHGV1zGJXwRDJ/FDJZi3MBQE10dL2K8gZFOGE3REDZyyjLunKG7KAzZHfMaXjXp+QbXYlzBfrvmSuhBNaHrxQU8zdQW8RhrOe0snuB7zA/jd6p4n9HV8QMfY/4JPzGAt7meFfS18LdXEk7uemIQuJ/Lj6PZQezFWhm3cTWnXcAj3MrU5oWh5WpzGM3UurGNZy28HSa8J7mB3Uy+4u/rl+UdrsT4Jraa6F6jP5M3MP0PHguzL9zzqmC2GRNYjXF2qDzDwgbgHp53wGMhJrEunGQ9oT3CQ+GFasWBsLVvwiv5XygJz/JOAe208POrJHST+CVspBB/AFY9Q3+QJqLxAAAAAElFTkSuQmCC" alt="Raymii.org Logo">
                    </a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>                 
                </small><br/><p>
                <link href="/s/_pagefind/pagefind-ui.css" rel="stylesheet">
                <script src="/s/_pagefind/pagefind-ui.js" type="text/javascript"></script>
                <div id="search" style="min-width:400px;max-width:1080px;"></div>
                <script>
                    window.addEventListener('DOMContentLoaded', (event) => {
                        new PagefindUI({ element: "#search" });
                    });
                </script>
                </p>
            </header>
          
    <main data-pagefind-body><h2 class='headheader' data-pagefind-meta='title' id='main'>Nitrokey HSM/SmartCard-HSM and Raspberry Pi web cluster</h2>
<p><small>Published: <span data-pagefind-meta='date'>01-08-2016</span> | Author: Remy van Elst | <a href="Nitrokey_HSM_web_cluster.txt">Text only version of this article</a>
</small></p>
<br><div class='olderthanayear'><p><strong>&#10071; This post is over seven years old. It may no longer be up to date. Opinions may have changed.</strong></p></div>
<div id="toc">
<h3>Table of Contents</h3>
<ul>
<li>
<a href="#toc_0">Introduction</a>
</li>
<li>
<a href="#toc_1">How many HSM&#39;s?</a>
</li>
<li>
<a href="#toc_2">Cluster setup</a>
</li>
<li>
<a href="#toc_3">Initialize the new HSM&#39;s</a>
</li>
<li>
<a href="#toc_4">Backup and restore the keys</a>
</li>
<li>
<a href="#toc_5">Raspberry Pi setup</a>
</li>
<li>
<a href="#toc_6">Apache setup</a>
</li>
<li>
<a href="#toc_7">Configure haproxy</a>
</li>
<li>
<a href="#toc_8">NGINX in TCP mode</a>
</li>
<li>
<a href="#toc_9">Charts and result interpretation</a>
<ul>
<li>
<a href="#toc_10">Siege result parsing</a>
</li>
<li>
<a href="#toc_11"><code>mod_ssl</code>. no HSM</a>
</li>
<li>
<a href="#toc_12">1024 bit RSA key</a>
</li>
<li>
<a href="#toc_13">2048 bit RSA key</a>
</li>
<li>
<a href="#toc_14">prime256v1 EC key</a>
</li>
<li>
<a href="#toc_15">Different keysizes, 1 HSM</a>
</li>
<li>
<a href="#toc_16">Burst mode</a>
</li>
</ul>
</li>
<li>
<a href="#toc_17">Conclusion</a>
</li>
<li>
<a href="#toc_18">Chart creation</a>
</li>
<li>
<a href="#toc_19">Benchmark process</a>
</li>
<li>
<a href="#toc_20">Benchmarks without the HSM</a>
<ul>
<li>
<a href="#toc_21">Benchmarking 1024 bit RSA key without HSM</a>
</li>
<li>
<a href="#toc_22">Benchmarking 2048 bit RSA key without HSM</a>
</li>
<li>
<a href="#toc_23">Benchmarking 4096 bit RSA key without HSM</a>
</li>
<li>
<a href="#toc_24">Benchmarking 8192 bit RSA key without HSM</a>
</li>
<li>
<a href="#toc_25">Benchmarking prime256v1 (NIST curve P-256) EC key without HSM</a>
</li>
</ul>
</li>
<li>
<a href="#toc_26">OpenSC benchmarks</a>
<ul>
<li>
<a href="#toc_27">1 HSM (OpenSC)</a>
<ul>
<li>
<a href="#toc_28">Benchmarking 1024 bit RSA key with 1 HSM (OpenSC)</a>
</li>
<li>
<a href="#toc_29">Benchmarking 2048 bit RSA key with 1 HSM (OpenSC)</a>
</li>
<li>
<a href="#toc_30">Benchmarking EC prime256v1 key with 1 HSM (OpenSC)</a>
</li>
</ul>
</li>
<li>
<a href="#toc_31">2 HSM&#39;s (OpenSC)</a>
<ul>
<li>
<a href="#toc_32">Benchmarking 1024 bit RSA key with 2 HSM&#39;s (OpenSC)</a>
</li>
<li>
<a href="#toc_33">Benchmarking 2048 bit RSA key with 2 HSM&#39;s (OpenSC)</a>
</li>
<li>
<a href="#toc_34">Benchmarking EC prime256v1 key with 2 HSM&#39;s (OpenSC)</a>
</li>
</ul>
</li>
<li>
<a href="#toc_35">3 HSM&#39;s (OpenSC)</a>
<ul>
<li>
<a href="#toc_36">Benchmarking 1024 bit RSA key with 3 HSM&#39;s (OpenSC)</a>
</li>
<li>
<a href="#toc_37">Benchmarking 2048 bit RSA key with 3 HSM&#39;s (OpenSC)</a>
</li>
<li>
<a href="#toc_38">Benchmarking EC prime256v1 key with 3 HSM&#39;s (OpenSC)</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_39">sc-hsm-embedded benchmarks</a>
<ul>
<li>
<a href="#toc_40">1 HSM (sc-hsm-embedded)</a>
<ul>
<li>
<a href="#toc_41">Benchmarking 1024 bit RSA key with 1 HSM (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_42">Benchmarking 2048 bit RSA key with 1 HSM (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_43">Benchmarking EC prime256v1 key with 1 HSM (sc-hsm-embedded)</a>
</li>
</ul>
</li>
<li>
<a href="#toc_44">2 HSM&#39;s (sc-hsm-embedded)</a>
<ul>
<li>
<a href="#toc_45">Benchmarking 1024 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_46">Benchmarking 2048 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_47">Benchmarking EC prime256v1 key with 2 HSM&#39;s (sc-hsm-embedded)</a>
</li>
</ul>
</li>
<li>
<a href="#toc_48">3 HSM&#39;s (sc-hsm-embedded)</a>
<ul>
<li>
<a href="#toc_49">Benchmarking 1024 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_50">Benchmarking 2048 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</a>
</li>
<li>
<a href="#toc_51">Benchmarking EC prime256v1 key with 3 HSM&#39;s (sc-hsm-embedded)</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div><hr><div id="contents">
<p><img src="https://raymii.org/s/inc/img/hsmcluster.jpg" alt=""></p>

<blockquote>
<p>The 3-Pi HSM cluster to be used for the cluster articles</p>
</blockquote>

<p>This article sets up a Nitrokey HSM/SmartCard-HSM web cluster and has a lot of
benchmarks. This specific HSM is not a fast HSM since it&#39;s very inexpensive and
targeted at secure key storage, not performance. But, what if you do want more
performance? Then you scale horizontally, just add some more HSM&#39;s and a
loadbalancer in front.</p>

<p>You want to put your private key material inside an HSM because it cannot be
stolen that way. A HSM does not allow key material to be exported, so nobody can
secretly copy the keys and use them without your knowledge. If the HSM is
tampered with, it will also wipe itself, so brute forcing it will not work.</p>

<p>The cluster consists of Raspberry Pi&#39;s and Nitrokey HSM&#39;s and SmartCard-HSM&#39;s,
softwarewise we use Apache, <code>mod_nss</code> and haproxy.</p>

<p>This is the first time I had an actual use case for Raspberry Pi&#39;s in a cluster,
and I really enjoyed doing it. I might even, in the future, add some more Pi&#39;s
on top and do some more benchmarks. But I already spent about two weeks working
on this single article so three was just fine for now.</p>

<p class="ad"> <b>Recently I removed all Google Ads from this site due to their invasive tracking, as well as Google Analytics. Please, if you found this content useful, consider a small donation using any of the options below:</b><br><br> <a href="https://leafnode.nl">I'm developing an open source monitoring app called  Leaf Node Monitoring, for windows, linux & android. Go check it out!</a><br><br> <a href="https://github.com/sponsors/RaymiiOrg/">Consider sponsoring me on Github. It means the world to me if you show your appreciation and you'll help pay the server costs.</a><br><br> <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">You can also sponsor me by getting a Digital Ocean VPS. With this referral link you'll get $100 credit for 60 days. </a><br><br> </p>

<p>Do note that two devices were sponsored for this article.</p>

<p>We benchmark a small HTML file and a Wordpress site using:</p>

<ul>
<li>a 8192 bit RSA certificate without using the HSM&#39;s</li>
<li>a 4096 bit RSA certificate without using the HSM&#39;s</li>
<li>a 2048 bit RSA certificate without using the HSM&#39;s</li>
<li>a 1024 bit RSA certificate without using the HSM&#39;s</li>
<li><p>a prime256v1 EC certificate without using the HSM&#39;s</p></li>
<li><p>a 2048 bit RSA certificate in the HSM</p></li>
<li><p>a 1024 bit RSA certificate in the HSM</p></li>
<li><p>a prime256v1 EC certificate in the HSM. </p></li>
</ul>

<p>We do these benchmarks with the <code>OpenSC</code> module and with the <code>sc-hsm-embedded</code>
module to see if that makes any difference.</p>

<p>The full raw results are provided at the end of the article. I first talk a bit
more about the HSM&#39;s, the cluster setup and the issues I had with the Raspberry
Pi&#39;s. Then we set up the three HSM devices and the load balancer. Finally,
before the raw results, we have nice charts and interpretation of the charts,
plus an unexpected conclusion.</p>

<h3 id="toc_0">Introduction</h3>

<p><img src="https://raymii.org/s/inc/img/sc-hsm-nitrokey.jpg" alt=""></p>

<blockquote>
<p>The Nitrokey HSM and the SmartCard-HSM</p>
</blockquote>

<p>The <a href="http://nitrokey.com">Nitrokey HSM</a> is an open hardware and open software device. It is a USB
version of the <a href="http://www.smartcard-hsm.com/">SmartCard-HSM</a>. Both the <a href="http://www.smartcard-hsm.com/opensource.html">SmartCard-HSM</a> as the <a href="https://github.com/nitrokey">Nitrokey
HSM</a> have sources available and are fully supported by the <a href="https://github.com/OpenSC/OpenSC/wiki/SmartCardHSM">OpenSC</a>
project.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<p><img src="https://raymii.org/s/inc/img/sc-hsm.jpg" alt=""></p>

<blockquote>
<p>The SmartCard-HSM</p>
</blockquote>

<p>If you are new to the NitroKey HSM/SmartCard HSM, please also <a href="https://raymii.org/s/articles/Get_Started_With_The_Nitrokey_HSM.html">read my getting
started</a> article. It explains what the HSM is, how to set it up and how to
use it with OpenSSH for example.</p>

<p>I have <a href="https://raymii.org/s/tags/nitrokey.html">multiple articles</a> on this nice device, so make sure to read the
others as well.</p>

<h3 id="toc_1">How many HSM&#39;s?</h3>

<p><img src="https://raymii.org/s/inc/img/3hsm.jpg" alt=""></p>

<blockquote>
<p>Three Nitrokey&#39;s in their bags</p>
</blockquote>

<p>This guide uses three Nitrokey HSM devices. I&#39;ve generated three keypairs on one
of the HSM&#39;s, one RSA 1024, one RSA 2048 and one EC key, just as we did in <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">the
<code>mod_nss</code> tutorial</a>. Please consult that article first, since the key
generation and certificate loading part is not included in this guide.</p>

<p>I&#39;ll refer to the HSM where the DKEK was initialized and the keys were generated
as HSM 1. The other two HSM&#39;s are referred two as HSM 2 and HSM 3.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<p>This guide uses three Raspberry Pi 3 comuters, wired network with Raspbian
testing (2016-07-29) and with the three HSM devices plugged in.</p>

<p>At first I tried to use the HSM&#39;s on the host computer, with different virtual
hosts. That works when using the OpenSC module, but not with the sc-hsm-embedded
module. <a href="https://github.com/CardContact/sc-hsm-embedded/issues/12">That module doesn&#39;t support token labels</a>, yet, so there was no way
to distinguish between them. I did try to setup three different NSS databases
where the HSM&#39;s were only enabled by ID but that still resulted in the three of
them being used. To make all tests equal, I went for a second option.</p>

<p>That second option was using three different virtual machines on the same PC
with VirtualBox and USB passthrough in VirtualBox:</p>

<p><img src="https://raymii.org/s/inc/img/hsmshare.png" alt=""></p>

<p>That however gave all kinds of errors with the HSM&#39;s in use. At first it worked
just fine with <code>mod_nss</code> but whenever I tried to do more than 5 concurrent
actions on the HSM the connection was lost and it became unresponsive, to the
part that even <code>sc-hsm-tool</code> did not recognize the HSM and a VM reboot was
required. So that wasn&#39;t a viable solution either. On to the third option it
was.</p>

<h3 id="toc_2">Cluster setup</h3>

<p>THe final solution was using three different computers. Since I wanted to keep
it simple, fair and not too expensive I decided to buy three Raspberry Pi 3&#39;s. I
bought them from the dutch store <a href="https://www.kiwi-electronics.nl/">Kiwi-Electronics</a> including two <a href="https://www.kiwi-electronics.nl/raspberry-pi-stackable-case-kit-black?search=stack">stackable
cases</a>. (These links are not affiliate links, just had a great experience
there. Their order confirmation lists the ordering IP, and in my case it was my
IPv6 address. Yay +1 for them!). The case comes from <a href="https://www.modmypi.com/blog/multi-pi-assembly-guide">ModMyPi</a> and I might
even just recreate it in Inkscape and use my lasercutter in the future for
expansion.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<p>The Raspberry Pi 3 Model B&#39;s have the following specs:</p>

<ul>
<li>1.2GHz 64-bit quad-core ARMv8 CPU</li>
<li>1 GB LPDDR2 RAM 900 MHz</li>
<li>100 Mbit NIC</li>
<li>4x USB 2.0</li>
</ul>

<p>They also have Wifi and bluetooth but I did not use that. All the benchmarks
were done over the wired network. The OS is <a href="https://raymii.org/s/blog/Raspberry_Pi_Raspbian_Unattended_Upgrade_Jessie_to_Testing.html">Raspbian Testing</a>. Since the
current normal Raspbian ships <code>OpenSC</code> 0.14 which doesn&#39;t support the SmartCard-
HSM/Nitrokey HSM an upgrade was required. The current testing ships with OpenSC
0.16, which does work with the SmartCard-HSM/Nitrokey HSM.</p>

<p>To combine the three machines into one single service I used <code>haproxy</code> in TCP
mode. <code>haproxy</code> is a very fast and scalable HTTP(s)/TCP load balancer. I&#39;ve used
it in production for many years now and have been happy with it ever since.</p>

<p>I did also try <code>nginx</code> since that also <a href="https://www.nginx.com/resources/admin-guide/tcp-load-balancing/">supports TCP and UDP load
balancing</a>. The results were very comparable, so I think the load balancer
is not the limiting factor here.</p>

<p>The software stack used on Raspbian Testing is the following:</p>

<ul>
<li>Apache 2.4.23 (Raspbian)</li>
<li>mpm_event</li>
<li>PHP 7.0.8-5</li>
<li>MySQL 5.6.30-1 (Raspbian)</li>
<li>php-fpm / fcgi</li>
<li>Wordpress 4.5.3</li>
<li><code>mod_nss</code> 1.0.12-2</li>
</ul>

<p>I&#39;m using <code>mpm_event</code> and <code>php-fpm</code> instead of <code>mpm_prefork</code> and <code>mod-php</code>
because of issues with the initialization of the HSM by all the workers. See
<a href="https://www.redhat.com/archives/mod_nss-list/2016-July/msg00000.html">the mailinglist thread here</a> for more information. Otherwise all kinds of
errors like <code>SSL Library Error: -8152 The key does not support the requested
operation</code> and <code>SSL Library Error: -8023 Unknown</code> and <code>SSL Library Error: -12216
Attempt to write encrypted data to underlying socket failed</code> and <code>SSL input
filter read failed.</code> occur.</p>

<p>To install all the software and configure everything except for the HSM key
generation I&#39;ve created a set of Ansible playbooks. Because nobody wants to
handcraft three special snowflakes. I&#39;ve burned through 7 MicroSD cards before
getting to a working setup. I also tried to use Arch and Ubuntu 16.04 but those
images all had their own instabillites, so I just settled on Raspbian testing.</p>

<p><img src="https://raymii.org/s/inc/img/ansible_nss.png" alt=""></p>

<p>I might put the playbooks on here someday, but now they are intertwined to much
with my personal playbooks to make sense without it.</p>

<p>How do you keep the HSM&#39;s apart? Well, I&#39;ve used a very high-tech solution for
that, namely using three different coloured key-cords:</p>

<p><img src="https://raymii.org/s/inc/img/hsmkeycord.jpg" alt=""></p>

<p>Stickers might also be an option.</p>

<h3 id="toc_3">Initialize the new HSM&#39;s</h3>

<p>Plug in HSM 2.</p>

<p>If you execute <code>sc-hsm-tool</code> it will notify you that the new HSM has never been
initialized:</p>

<pre><code>$ sc-hsm-tool 
</code></pre>

<p>Output:</p>

<pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00
Version              : 2.0
SmartCard-HSM has never been initialized. Please use --initialize to set SO-PIN and user PIN.
</code></pre>

<p>HSM 1 was initialized with one DKEK share. We initialize the new HSMs and import
the DKEK share, to make sure the key backups work. We also give it a different
label.</p>

<pre><code>sc-hsm-tool --initialize --so-pin 3537363231383830 --pin 648219 --dkek-shares 1 --label &#39;hsm2&#39;
</code></pre>

<p>Output:</p>

<pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00
</code></pre>

<p>Import the DKEK share:</p>

<pre><code>sc-hsm-tool --import-dkek-share dkek-share-1.pbe
</code></pre>

<p>Output:</p>

<pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00
Enter password to decrypt DKEK share : 123456789

Deciphering DKEK share, please wait...
DKEK share imported
DKEK shares          : 1
DKEK key check value : 0FB85F69F6EBF256
</code></pre>

<p>Repeat the above process for HSM 3 and any more HSM&#39;s you have. Make sure to
give them descriptive labels. Unplug the other HSM&#39;s when initializing one, to
make sure you don&#39;t overwrite the wrong one.</p>

<p>The new HSM&#39;s are now initialized with the same DKEK as the old HSM. The next
step is to securely backup the existing keys from the old HSM and import them
into the new HSMs. This works because we&#39;re using the same DKEK.</p>

<h3 id="toc_4">Backup and restore the keys</h3>

<p>Plug in HSM 1.</p>

<p>Wrap (export) the keys on HSM 1:</p>

<pre><code>sc-hsm-tool --wrap-key wrap-key-1.bin --key-reference 1 --pin 648219
sc-hsm-tool --wrap-key wrap-key-2.bin --key-reference 2 --pin 648219
sc-hsm-tool --wrap-key wrap-key-3.bin --key-reference 3 --pin 648219
</code></pre>

<p>Output:</p>

<pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 00 00
</code></pre>

<p>Plug in HSM 2.</p>

<p>Unwrap (import) the keys on the HSM 2:</p>

<pre><code>sc-hsm-tool --unwrap-key wrap-key-1.bin --key-reference 1 --pin 648219
sc-hsm-tool --unwrap-key wrap-key-2.bin --key-reference 2 --pin 648219
sc-hsm-tool --unwrap-key wrap-key-3.bin --key-reference 3 --pin 648219
</code></pre>

<p>Output:</p>

<pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 00 00
Wrapped key contains:
  Key blob
  Private Key Description (PRKD)
  Certificate
Key successfully imported
</code></pre>

<p>Repeat this for HSM 3.</p>

<p>With all the keys imported and three HSM&#39;s plugged in, <code>pkcs11-tool</code> gives some
nice output:</p>

<pre><code>pkcs11-tool --module opensc-pkcs11.so --login --pin 648219 --list-slots
Available slots:
Slot 0 (0x0): Nitrokey Nitrokey HSM (010000000000000000000000) 00 00
  token label        : hsm3 (UserPIN)
  token manufacturer : www.CardContact.de
  token model        : PKCS#15 emulated
  token flags        : rng, login required, PIN initialized, token initialized
  hardware version   : 24.13
  firmware version   : 2.0
  serial num         : DENK0100485
Slot 1 (0x4): Lenovo Integrated Smart Card Reader 01 00
  (empty)
Slot 2 (0x8): Nitrokey Nitrokey HSM (010000000000000000000000) 02 00
  token label        : hsm1 (UserPIN)
  token manufacturer : www.CardContact.de
  token model        : PKCS#15 emulated
  token flags        : rng, login required, PIN initialized, token initialized
  hardware version   : 24.13
  firmware version   : 2.0
  serial num         : DENK0100186
Slot 3 (0xc): Nitrokey Nitrokey HSM (010000000000000000000000) 03 00
  token label        : hsm2 (UserPIN)
  token manufacturer : www.CardContact.de
  token model        : PKCS#15 emulated
  token flags        : rng, login required, PIN initialized, token initialized
  hardware version   : 24.13
  firmware version   : 2.0
  serial num         : DENK0100436
</code></pre>

<p>If you want to do operations on a specific device you can add the <code>--slot</code>
parameter to the <code>pkcs11-tool</code> command. For example, to generate a key just on
HSM 2 (slot 3/c):</p>

<pre><code>$ pkcs11-tool --module opensc-pkcs11.so --login --pin 648219 --keypairgen --key-type EC:prime256v1 --slot c --id 10 --label &quot;ect&quot;
</code></pre>

<h3 id="toc_5">Raspberry Pi setup</h3>

<p>The Raspberry Pi&#39;s are on the network via a wired connection. They run <a href="https://raymii.org/s/blog/Raspberry_Pi_Raspbian_Unattended_Upgrade_Jessie_to_Testing.html">Raspbian
Testing</a> because of the OpenSC version.</p>

<p>The following steps should be done on the three Pi&#39;s:</p>

<ul>
<li>HSM driver installation (OpenSC)</li>
<li>Apache and <code>mod_nss</code> installation</li>
<li>NSS Certificate database setup</li>
<li>Apache and <code>mod_nss</code> configuration</li>
</ul>

<p>Please consult the <a href="https://raymii.org/s/articles/Nitrokey_HSM_in_Apache_with_mod_nss.html">mod_nss opensc</a> guide or the <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">mod_nss with sc-hsm-
embedded</a> guide for the specific setup and repeat that on all the Raspberry
Pi&#39;s. I&#39;m not going to cover the setup here any further.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<h3 id="toc_6">Apache setup</h3>

<p>Remember to not use <code>mod_php</code> and <code>mpm_prefork</code>. I used <code>mpm_event</code> and <code>php-
fpm</code> (PHP 7).</p>

<p>Here is the <code>mpm_event</code> configuration:</p>

<pre><code>    StartServers             20
    MinSpareThreads          250
    MaxSpareThreads          500
    ThreadLimit              64
    ThreadsPerChild          25
    MaxRequestWorkers        500
    MaxConnectionsPerChild   150
</code></pre>

<p>I couldn&#39;t get <code>fastcgi</code> to run, but it seems Apache uses its own module now
(<code>proxy_fcgi</code>).</p>

<p>Make sure to restart Apache after configuring.</p>

<p>Repeat this step on all the VM&#39;s.</p>

<h3 id="toc_7">Configure haproxy</h3>

<p>Make sure you have haproxy installed:</p>

<pre><code>apt-get install haproxy
</code></pre>

<p>I&#39;m using version 1.6.6. I&#39;ve got a few <a href="https://raymii.org/s/tags/haproxy.html">other articles</a> on HAproxy if
you&#39;re interested. HAproxy does not run on the Raspberry Pi&#39;s, but on my local
host (A Lenovo Thinkpad x240, i5, 8GB RAM, Arch linux), so don&#39;t install this in
the VM&#39;s.</p>

<p>HAproxy can do many things in http mode, but we&#39;re not using that. We will be
using <code>tcp</code> mode with a <code>roundrobin</code> configuration. This means that when
requests come in, haproxy proxy&#39;s the TCP connection to the backends. Request
one goes to hsm1, request two to hsm 2, request 3 to hsm 3 and request 4 goes to
hsm 1. This way the server can handle more concurrent requests. This is my basic
haproxy configuration file, <code>/etc/haproxy/haproxy.cfg</code>:</p>

<pre><code>global
    maxconn     20000
    log         hsmcluster.nl local0
    user        haproxy
    chroot      /usr/share/haproxy
    pidfile     /run/haproxy.pid
    daemon

frontend hsm
    bind *:443
    mode tcp
    default_backend hsm
    timeout client 1m

backend hsm
    mode tcp
    balance roundrobin
    timeout connect 10s
    timeout server 1m

    server hsm01 10.0.0.106:8443
    server hsm02 10.0.0.107:8443
    server hsm03 10.0.0.108:8443
</code></pre>

<p>My VM&#39;s have the <code>10.0.0.106</code>, <code>107</code> and <code>108</code> addresses.</p>

<p>Restart <code>haproxy</code> after changing the config.</p>

<p>In my <code>hosts</code> file I&#39;ve setup the domain <a href="https://hsmcluster.nl">hsmcluster.nl</a> on localhost.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<h3 id="toc_8">NGINX in TCP mode</h3>

<p>If you prefer to use NGINX then you can use this example configuration:</p>

<pre><code>worker_processes  1;
events {
    worker_connections  1024;
}

stream {
    server {
      listen 443;
      proxy_pass hsm_backend;
    }

    upstream hsm_backend {
      server 10.0.0.106:443;
      server 10.0.0.100:443;
      server 10.0.0.105:443;
    }
}
</code></pre>

<h3 id="toc_9">Charts and result interpretation</h3>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<p>Here below I&#39;ll look into the various aspects and results of the benchmark. The
last section of the article gives you the raw numbers/benchmark siege results to
play around yourself. This is the more readable part if you&#39;re not into number
crunching.</p>

<h4 id="toc_10">Siege result parsing</h4>

<p>Siege gives you different types of metrics. We do the same benchmark over and
over so we&#39;re interesed in some, not all. The time for example is 30 seconds
everywhere. Here is, <a href="https://www.joedog.org/siege-manual/#a08">from the manual</a>, the explanation of the metrics we
use.</p>

<ul>
<li>Transactions is the number of server hits.</li>
<li>Response time is the average time it took to respond to each simulated user&#39;s requests.</li>
<li>Transaction rate is the average number of transactions the server was able to handle per second, in a nutshell: transactions divided by elapsed time.</li>
<li>Concurrency is average number of simultaneous connections, a number which rises as server performance decreases.</li>
</ul>

<h4 id="toc_11"><code>mod_ssl</code>. no HSM</h4>

<p><img src="https://raymii.org/s/inc/img/hsm/no-hsm-mod_ssl.png" alt=""></p>

<p>As we can see here the 1024 bit RSA key is the fastest. 2048 bit RSA is just a
tidbit slower, but still acceptable. 4096 bit RSA keys take a huge dump down in
transactions and the response time and concurrency go up.</p>

<p>8192 bit RSA keys slow down to a grinding halt, huge response time, low
transaction rate. It might be super secure, but super slow as well.</p>

<p>Same goes for the EC prime256v1 keys. Most of the time EC keys are faster, but
it seems the Pi&#39;s have trouble with it, just as much as with the 8192 bit RSA
keys.</p>

<h4 id="toc_12">1024 bit RSA key</h4>

<p><img src="https://raymii.org/s/inc/img/hsm/1024-bit-rsa.png" alt=""></p>

<p>We can see that the HSM is around 8 times slower than using regular <code>mod_ssl</code>.
But, we knew that already. Adding a HSM to the loadbalancer doubles the
performance, and adding two HSM&#39;s to the loadbalancer triples it, as we would
expect. So, going down that route, if we have 8 HSM&#39;s, it would be just as fast
as regular <code>mod_ssl</code>.</p>

<p>Something that caught my eye was that with one HSM the <code>OpenSC</code> module was
faster. (Remember, best of three for the tests, every test is done three times,
best result is kept.). When using multiple HSM&#39;s we see a small gain in
transactions when using <code>sc-hsm-embedded</code>. I&#39;m not quite sure why that is, but
it&#39;s something that steps out.</p>

<p>But, as we all know, using an 1024 bit RSA key is considered insecure. So don&#39;t
do that in production.</p>

<p>Here is the same data with only the HSM&#39;s so that you can see the differences
better between OpenSC and sc-embedded-hsm:</p>

<p><img src="https://raymii.org/s/inc/img/hsm/1024-bit-rsa-hsm.png" alt=""></p>

<h4 id="toc_13">2048 bit RSA key</h4>

<p><img src="https://raymii.org/s/inc/img/hsm/2048-bit-rsa.png" alt=""></p>

<p>2048 bit keys are way harder for the HSM, but not at all for regular <code>mod_ssl</code>.
In this case it is about 26 times slower when using a HSM, comparing to no HSM.
Here we see again that the transaction rate is doubled and trippled when adding
HSM&#39;s to the cluster. The same thing here with sc-hsm-embedded, when used with 1
HSM it&#39;s slower, but when scaling up it becomes a little bit faster.</p>

<p>Here is the same data with only the HSM&#39;s so that you can see the differences
better between OpenSC and sc-embedded-hsm:</p>

<p><img src="https://raymii.org/s/inc/img/hsm/2048-bit-rsa-hsm.png" alt=""></p>

<h4 id="toc_14">prime256v1 EC key</h4>

<p><img src="https://raymii.org/s/inc/img/hsm/prime256v1-ec.png" alt=""></p>

<p>I think the Pi&#39;s have trouble with the prime256v1 EC key. When using just one
HSM, the performance almost doubles. When we use three HSM&#39;s the performance is
almost as good as with the 1024 bit RSA key. In all cases OpenSC was slower than
the sc-hsm-embedded module.</p>

<p>What suprises me the most is that EC algorithms are supposed to be faster then
RSA. It might be that non-Pi hardware has the AES-NI extension or something.</p>

<h4 id="toc_15">Different keysizes, 1 HSM</h4>

<p><img src="https://raymii.org/s/inc/img/hsm/different-keys-hsms.png" alt=""></p>

<p>This is an interesting one. We see that the EC prime256v1 key is almost as fast
as the RSA 1024 bit key. Also, OpenSC is slower here with the EC keypair. <a href="https://security.stackexchange.com/a/78624">Most
browsers</a> support prime256v1, also named NIST curve P-256. There however are
some concerns <a href="https://www.nsa.gov/ia/programs/suiteb_cryptography/">since the NSA is involved</a>. Keep that in mind. Still, the
fastest modern algorithm in this HSM.</p>

<h4 id="toc_16">Burst mode</h4>

<p>The burst mode benchmark is different than the above ones. The above tests take
a random amount of seconds between 1 and 5 and delay each connection that
amount. This gives you a more realistic test than when your just hammering every
second. Hammering every second is a performance measure, because you can then
measure how many connections your server could handle at peak times.</p>

<p>This test fires of 60 connections for half a minute and doesnt take any time
between them. Just bang bang bang. The results differ from the 20 connection
test because the HSM then has some time to recover, so to say, between
connections. The more HSM&#39;s you add to the cluster, the more time each one will
have to recover, the better your tests will be.</p>

<p>The burst benchmark doesn&#39;t hit the wordpress site but the small text file.</p>

<p><img src="https://raymii.org/s/inc/img/hsm/60-1024.png" alt=""></p>

<p>The chart above is for an 1024 bit RSA key. We see that without the HSM it is
the fastest, topping a whopping 7000+ transactions. Here is the picture without
that, so make it more clear what the differences with HSM are.</p>

<p><img src="https://raymii.org/s/inc/img/hsm/60-1024-hsm.png" alt=""></p>

<p>Same results as above, adding more HSM&#39;s gives better performance. Note that sc-
hsm-embedded is only faster in the 3 HSM test.</p>

<p>This is the score for 2048 bit keys, including the test without the HSM:</p>

<p><img src="https://raymii.org/s/inc/img/hsm/60-2048.png" alt=""></p>

<p>Same as above, more HSM makes stuff faster, without the HSM we see an enourmus
speed bump. Here&#39;s the graph without the last part:</p>

<p><img src="https://raymii.org/s/inc/img/hsm/60-2048-hsm.png" alt=""></p>

<p>Strange, sc-embedded-hsm is only faster here with 2 HSM&#39;s and OpenSC was
significantly lower with 2 HSM&#39;s. I did rone this specific test again a few
times but all gave comparable results.</p>

<p>Last but not least, the prime256v1 EC key. This is the only time where the HSM
is faster, I suspect because it provides offloading (the Pi lacks crypto
hardware?).</p>

<p><img src="https://raymii.org/s/inc/img/hsm/60-prime256v1.png" alt=""></p>

<p>Using the HSM here almost doubles the performance, using three HSM&#39;s you get
almost 6 times the performance of no HSM. I did not expect this at all, but I do
find it awesome.</p>

<h3 id="toc_17">Conclusion</h3>

<ul>
<li>Using this HSM with RSA is significantly slower than not using this HSM</li>
<li>Using this HSM with EC is significantly faster than not using this HSM</li>
<li>8192 bit RSA is slower than trying to nail hammer <a href="https://raymii.org/s/inc/img/pudding.jpg">jelly pudding</a> to a wall</li>
<li>Adding one HSM to the cluster doubles the performance</li>
<li>Adding two HSM&#39;s to the cluster tripples the performance</li>
<li>You need about 10 HSM&#39;s (for RSA 1024) or 26 HSM&#39;s (for RSA 2048) to have the same performance without a HSM</li>
<li>You need about two Pi&#39;s without a HSM to have the same performance as with one HSM with prime256v1 EC.</li>
</ul>

<p>In general this was what I expected, except for the EC part. As said at the
start of the article, the Nitrokey/SmartCard-HSM is not built for this use case,
although it works absolutely fine, just a bit slower.</p>

<p>I&#39;ve browsed the wordpress site, did some searching, installed some plugins
(slider, contact form etc) and created a few blog posts, which all works just
fine. I have 500/500 mbit fiber at home so I do notice the delay, but the
performance is comparable to a location with regular DSL and a 8/2 mbit speed.
Which means I&#39;m spoiled and most people will not notice the difference.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10
credit). (referral link)</a></p>

<p>Below I&#39;ll talk more about something I tried first for the graphs and then give
you more information on the benchmarks and the raw results.</p>

<h3 id="toc_18">Chart creation</h3>

<p>I first tried to use GNUPlot to create charts based on the <code>siege</code> log file with
the following gnuplot file:</p>

<pre><code>set term png truecolor size 600,600
set output &quot;data.png&quot;
set title &quot;2048 bit RSA key&quot;
set boxwidth 1 relative
set grid
set key outside;
set key top;
set style fill transparent solid 0.5 border rgb&quot;black&quot;
set style data histogram
set style fill solid border
set style histogram clustered

plot for [COL=2:4] &#39;siegedata&#39; using COL:xticlabels(1) title columnheader 
</code></pre>

<p>The siege log is transformed to a usable datafile using the following commands:</p>

<pre><code>awk -F, &#39;{print $2&quot;:&quot;$5&quot;:&quot;$8}&#39; siege.log  | awk &#39;{print NR-1&quot;-PI:&quot;,$0}&#39; | sed &#39;s/\s\+//g&#39;  | sed -e &#39;1s/^...../Number /&#39; -e &#39;s/:/ /g&#39;
</code></pre>

<p>This is the result of the command:</p>

<pre><code>Number Trans RespTime Concurrent
1-HSM 9 0.83 0.25
2-HSM 23 1.06 0.82
3-HSM 124 2.34 9.68
</code></pre>

<p>The original siege log was:</p>

<pre><code>      Date &amp; Time,  Trans,  Elap Time,  Data Trans,  Resp Time,  TransRate,  Throughput,  Concurrent,    OKAY,   Failed
1 2016-07-31 08:35:21,      9,      29.86,           0,       0.83,        0.30,        0.00,        0.25,       9,       0
2 2016-07-31 08:36:39,     23,      29.60,           0,       1.06,        0.78,        0.00,        0.82,      23,      21
3 2016-07-31 08:40:15,    124,      29.99,           0,       2.34,        4.13,        0.00,        9.68,     124,       0
</code></pre>

<p>This would give me a graph like below:</p>

<p><img src="https://raymii.org/s/inc/img/hsm/example.png" alt=""></p>

<p>But that doesn&#39;t scale very well for larger and smaller numbers and I didn&#39;t
like the overall look. So I looked around for simple online charting services
and via Opensource.com found <a href="https://datawrapper.de">Datawrapper</a>. It&#39;s a nice service, lots of
options while keeping it simple. I shoved them $12 to export the images because
I&#39;m to lazy to <a href="https://github.com/datawrapper/datawrapper">host it myself</a> or take screenshots. People put effort into
hosting and development, so let&#39;s reward them for it.</p>

<h3 id="toc_19">Benchmark process</h3>

<p>All the benchmarks were done three times and the best result is used. The
machine that runs haproxy wasn&#39;t doing anything else at the time, measured with
nethogs. No spotify or skype skewing the benchmarks. All was done via a wired
gigabit network, cat6 cabling.</p>

<p>I&#39;ve also done benchmarks without the HSM, just regular apache with <code>mod_ssl</code>.
Why not <code>mod_nss</code> you might ask? Well, because nobody will setup <code>mod_nss</code> when
they can use <code>mod_ssl</code>. All the guides use <code>mod_ssl</code>.and the most sites online
are using it. Only if you have special software or need PKCS#11 you need to use
mod_nss.</p>

<h3 id="toc_20">Benchmarks without the HSM</h3>

<p>The below benchmarks does not use the HSM, just regular <code>mod_ssl</code> and a
certificate file. We&#39;re benchmarking one small page with only the contents &#39;Jeej
it works!&#39;. We&#39;re also benchmarking a Wordpress 4.5.3 install with the default
content after install and the Hemmingway theme.</p>

<p>I&#39;m not benchmarking multiple Pi&#39;s since the result of one Pi and the result of
three Pi&#39;s was so comparable, I suspect they are fast enough and that <code>mod_ssl</code>
doesn&#39;t have any bottlenecks there. Except for some tests, those just blew up
the Pi&#39;s. (8192 bit keys).</p>

<p>The HSM does not support 4096 or 8192 bit RSA keys, which is why I didnot test
those with the HSM&#39;s.</p>

<p>Here below are all the benchmarking results. Every benchmark was done three
times, best result was kept.</p>

<h4 id="toc_21">Benchmarking 1024 bit RSA key without HSM</h4>

<p>Self signed with OpenSSL:</p>

<pre><code>#key + certificate
openssl req -nodes -x509 -sha256 -newkey rsa:1024 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;
</code></pre>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     63 hits
Availability:                 100.00 %
Elapsed time:                  29.47 secs
Data transferred:               0.00 MB
Response time:                  0.04 secs
Transaction rate:               2.14 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.08
Successful transactions:          63
Failed transactions:               0
Longest transaction:            0.06
Shortest transaction:           0.02
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    119 hits
Availability:                 100.00 %
Elapsed time:                  29.67 secs
Data transferred:               0.00 MB
Response time:                  0.04 secs
Transaction rate:               4.01 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.16
Successful transactions:         119
Failed transactions:               0
Longest transaction:            0.10
Shortest transaction:           0.02
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    239 hits
Availability:                 100.00 %
Elapsed time:                  29.80 secs
Data transferred:               0.00 MB
Response time:                  0.04 secs
Transaction rate:               8.02 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.30
Successful transactions:         239
Failed transactions:               0
Longest transaction:            0.13
Shortest transaction:           0.02
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                   7331 hits
Availability:                 100.00 %
Elapsed time:                  29.18 secs
Data transferred:               0.09 MB
Response time:                  0.23 secs
Transaction rate:             251.23 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   56.54
Successful transactions:        7331
Failed transactions:               0
Longest transaction:            1.47
Shortest transaction:           0.03
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    772 hits
Availability:                 100.00 %
Elapsed time:                  29.84 secs
Data transferred:               5.63 MB
Response time:                  0.06 secs
Transaction rate:              25.87 trans/sec
Throughput:                     0.19 MB/sec
Concurrency:                    1.67
Successful transactions:         772
Failed transactions:               0
Longest transaction:            0.75
Shortest transaction:           0.02
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                   1353 hits
Availability:                 100.00 %
Elapsed time:                  29.09 secs
Data transferred:               9.87 MB
Response time:                  0.09 secs
Transaction rate:              46.51 trans/sec
Throughput:                     0.34 MB/sec
Concurrency:                    4.23
Successful transactions:        1353
Failed transactions:               0
Longest transaction:            2.46
Shortest transaction:           0.02
</code></pre>

<h4 id="toc_22">Benchmarking 2048 bit RSA key without HSM</h4>

<p>Self signed with OpenSSL:</p>

<pre><code>#key + certificate
openssl req -nodes -x509 -sha256 -newkey rsa:2048 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;
</code></pre>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     51 hits
Availability:                 100.00 %
Elapsed time:                  29.28 secs
Data transferred:               0.00 MB
Response time:                  0.06 secs
Transaction rate:               1.74 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.10
Successful transactions:          51
Failed transactions:               0
Longest transaction:            0.10
Shortest transaction:           0.04
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    126 hits
Availability:                 100.00 %
Elapsed time:                  29.68 secs
Data transferred:               0.00 MB
Response time:                  0.07 secs
Transaction rate:               4.25 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.28
Successful transactions:         126
Failed transactions:               0
Longest transaction:            0.19
Shortest transaction:           0.04
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Lifting the server siege...
Transactions:                    253 hits
Availability:                 100.00 %
Elapsed time:                  29.57 secs
Data transferred:               0.00 MB
Response time:                  0.07 secs
Transaction rate:               8.56 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.60
Successful transactions:         253
Failed transactions:               0
Longest transaction:            0.28
Shortest transaction:           0.04
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                   2999 hits
Availability:                 100.00 %
Elapsed time:                  29.92 secs
Data transferred:               0.04 MB
Response time:                  0.58 secs
Transaction rate:             100.23 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   58.55
Successful transactions:        2999
Failed transactions:               0
Longest transaction:            1.87
Shortest transaction:           0.14
</code></pre>

<p>60 benchmark mode with 3 Pi&#39;s in haproxy:</p>

<pre><code>Transactions:                   4890 hits
Availability:                 100.00 %
Elapsed time:                  29.80 secs
Data transferred:               0.06 MB
Response time:                  0.36 secs
Transaction rate:             164.09 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   58.74
Successful transactions:        4890
Failed transactions:               0
Longest transaction:            1.42
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    707 hits
Availability:                 100.00 %
Elapsed time:                  29.66 secs
Data transferred:               5.16 MB
Response time:                  0.10 secs
Transaction rate:              23.84 trans/sec
Throughput:                     0.17 MB/sec
Concurrency:                    2.29
Successful transactions:         707
Failed transactions:               0
Longest transaction:            1.86
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                   1267 hits
Availability:                 100.00 %
Elapsed time:                  29.62 secs
Data transferred:               9.25 MB
Response time:                  0.12 secs
Transaction rate:              42.78 trans/sec
Throughput:                     0.31 MB/sec
Concurrency:                    5.26
Successful transactions:        1267
Failed transactions:               0
Longest transaction:            2.55
Shortest transaction:           0.04
</code></pre>

<h4 id="toc_23">Benchmarking 4096 bit RSA key without HSM</h4>

<p>Self signed with OpenSSL:</p>

<pre><code>#key + certificate
openssl req -nodes -x509 -sha256 -newkey rsa:4096 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;
</code></pre>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     51 hits
Availability:                 100.00 %
Elapsed time:                  29.47 secs
Data transferred:               0.00 MB
Response time:                  0.22 secs
Transaction rate:               1.73 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.38
Successful transactions:          51
Failed transactions:               0
Longest transaction:            0.45
Shortest transaction:           0.19
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    117 hits
Availability:                 100.00 %
Elapsed time:                  29.85 secs
Data transferred:               0.00 MB
Response time:                  0.29 secs
Transaction rate:               3.92 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.14
Successful transactions:         117
Failed transactions:               0
Longest transaction:            0.87
Shortest transaction:           0.19  
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    234 hits
Availability:                 100.00 %
Elapsed time:                  29.30 secs
Data transferred:               0.00 MB
Response time:                  0.29 secs
Transaction rate:               7.99 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    2.31
Successful transactions:         234
Failed transactions:               0
Longest transaction:            1.14
Shortest transaction:           0.19
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    591 hits
Availability:                 100.00 %
Elapsed time:                  29.94 secs
Data transferred:               0.01 MB
Response time:                  2.91 secs
Transaction rate:              19.74 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   57.35
Successful transactions:         592
Failed transactions:               0
Longest transaction:            3.82
Shortest transaction:           0.40
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    483 hits
Availability:                 100.00 %
Elapsed time:                  29.22 secs
Data transferred:               3.53 MB
Response time:                  0.27 secs
Transaction rate:              16.53 trans/sec
Throughput:                     0.12 MB/sec
Concurrency:                    4.46
Successful transactions:         483
Failed transactions:               0
Longest transaction:            1.98
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    577 hits
Availability:                 100.00 %
Elapsed time:                  29.69 secs
Data transferred:               4.08 MB
Response time:                  0.67 secs
Transaction rate:              19.43 trans/sec
Throughput:                     0.14 MB/sec
Concurrency:                   13.10
Successful transactions:         577
Failed transactions:               0
Longest transaction:            2.37
Shortest transaction:           0.04
</code></pre>

<h4 id="toc_24">Benchmarking 8192 bit RSA key without HSM</h4>

<p>Self signed with OpenSSL:</p>

<pre><code>#key + certificate
openssl req -nodes -x509 -sha256 -newkey rsa:8192 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;
</code></pre>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     39 hits
Availability:                 100.00 %
Elapsed time:                  29.84 secs
Data transferred:               0.00 MB
Response time:                  1.36 secs
Transaction rate:               1.31 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.77
Successful transactions:          39
Failed transactions:               0
Longest transaction:            1.81
Shortest transaction:           1.30
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     70 hits
Availability:                 100.00 %
Elapsed time:                  29.94 secs
Data transferred:               0.00 MB
Response time:                  1.81 secs
Transaction rate:               2.34 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    4.22
Successful transactions:          70
Failed transactions:               0
Longest transaction:            3.38
Shortest transaction:           1.30
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     71 hits
Availability:                 100.00 %
Elapsed time:                  29.25 secs
Data transferred:               0.00 MB
Response time:                  5.13 secs
Transaction rate:               2.43 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   12.44
Successful transactions:          71
Failed transactions:               0
Longest transaction:            6.78
Shortest transaction:           1.36
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>This benchmark was done against THREE Pi&#39;s, one or two would fail and give the
Pi a load of +100.</p>

<p>Result:</p>

<pre><code>Transactions:                    176 hits
Availability:                 100.00 %
Elapsed time:                  29.75 secs
Data transferred:               0.00 MB
Response time:                  5.44 secs
Transaction rate:               5.92 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   32.21
Successful transactions:         176
Failed transactions:               0
Longest transaction:           22.08
Shortest transaction:           1.30
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     40 hits
Availability:                 100.00 %
Elapsed time:                  29.05 secs
Data transferred:               0.08 MB
Response time:                  6.76 secs
Transaction rate:               1.38 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    9.31
Successful transactions:          40
Failed transactions:               0
Longest transaction:            7.89
Shortest transaction:           5.62
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     62 hits
Availability:                 100.00 %
Elapsed time:                  29.39 secs
Data transferred:               0.10 MB
Response time:                  7.28 secs
Transaction rate:               2.11 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   15.36
Successful transactions:          62
Failed transactions:               0
Longest transaction:            8.41
Shortest transaction:           5.33
</code></pre>

<h4 id="toc_25">Benchmarking prime256v1 (NIST curve P-256) EC key without HSM</h4>

<p>Self signed with OpenSSL:</p>

<pre><code>#key
openssl ecparam -out ec_key.pem -name pi1.hsmcluster.nl.key -name prime256v1 -genkey
#certificate
openssl req -new -key pi1.hsmcluster.nl.key -x509 -nodes -days 365 -out pi1.hsmcluster.nl.cert -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;
</code></pre>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     41 hits
Availability:                 100.00 %
Elapsed time:                  29.79 secs
Data transferred:               0.00 MB
Response time:                  1.37 secs
Transaction rate:               1.38 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.89
Successful transactions:          41
Failed transactions:               0
Longest transaction:            2.12
Shortest transaction:           1.29
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     70 hits
Availability:                 100.00 %
Elapsed time:                  29.31 secs
Data transferred:               0.00 MB
Response time:                  1.72 secs
Transaction rate:               2.39 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    4.11
Successful transactions:          70
Failed transactions:               0
Longest transaction:            3.46
Shortest transaction:           1.29
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     76 hits
Availability:                 100.00 %
Elapsed time:                  29.35 secs
Data transferred:               0.00 MB
Response time:                  5.10 secs
Transaction rate:               2.59 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   13.21
Successful transactions:          76
Failed transactions:               0
Longest transaction:            6.59
Shortest transaction:           1.33
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>This benchmark was done against THREE Pi&#39;s, one or two would fail and give the
Pi a load of +100.</p>

<p>Result:</p>

<pre><code>Transactions:                     60 hits
Availability:                 100.00 %
Elapsed time:                  29.66 secs
Data transferred:               0.00 MB
Response time:                 23.60 secs
Transaction rate:               2.02 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   47.74
Successful transactions:          60
Failed transactions:               0
Longest transaction:           26.21
Shortest transaction:          20.71
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     86 hits
Availability:                 100.00 %
Elapsed time:                  29.18 secs
Data transferred:               0.55 MB
Response time:                  2.93 secs
Transaction rate:               2.95 trans/sec
Throughput:                     0.02 MB/sec
Concurrency:                    8.63
Successful transactions:          86
Failed transactions:               0
Longest transaction:            4.49
Shortest transaction:           0.05
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     80 hits
Availability:                 100.00 %
Elapsed time:                  29.19 secs
Data transferred:               0.17 MB
Response time:                  6.75 secs
Transaction rate:               2.74 trans/sec
Throughput:                     0.01 MB/sec
Concurrency:                   18.50
Successful transactions:          80
Failed transactions:               0
Longest transaction:            8.17
Shortest transaction:           6.10
</code></pre>

<h3 id="toc_26">OpenSC benchmarks</h3>

<p>The below benchmarks utilize the <code>opensc-pkcs11</code> module with <code>mod_nss</code>. We&#39;re
benchmarking one small page with only the contents &#39;Jeej it works!&#39;. We&#39;re also
benchmarking a Wordpress 4.5.3 install with the default content after install
and the Hemmingway theme.</p>

<p>Note to self, the below command formats the <code>siege</code> output directly to space-
seperated (instead of tab) markdown code output:</p>

<pre><code>siege  -c10 -d5 -t30S &#39;https://hsmcluster.nl/&#39; 2&gt;&amp;1 | grep -v &#39;==&gt; GET &#39; | expand | sed &#39;s/^/    /&#39;
</code></pre>

<h4 id="toc_27">1 HSM (OpenSC)</h4>

<h5 id="toc_28">Benchmarking 1024 bit RSA key with 1 HSM (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     52 hits
Availability:                 100.00 %
Elapsed time:                  29.52 secs
Data transferred:               0.00 MB
Response time:                  0.33 secs
Transaction rate:               1.76 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.57
Successful transactions:          52
Failed transactions:               0
Longest transaction:            1.06
Shortest transaction:           0.22
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    101 hits
Availability:                 100.00 %
Elapsed time:                  29.07 secs
Data transferred:               0.00 MB
Response time:                  0.52 secs
Transaction rate:               3.47 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.80
Successful transactions:         101
Failed transactions:               0
Longest transaction:            2.06
Shortest transaction:           0.22
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    142 hits
Availability:                 100.00 %
Elapsed time:                  29.86 secs
Data transferred:               0.00 MB
Response time:                  1.78 secs
Transaction rate:               4.76 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    8.47
Successful transactions:         142
Failed transactions:               0
Longest transaction:            5.07
Shortest transaction:           0.23
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    126 hits
Availability:                 100.00 %
Elapsed time:                  29.37 secs
Data transferred:               0.00 MB
Response time:                  8.96 secs
Transaction rate:               4.29 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   38.46
Successful transactions:         126
Failed transactions:               0
Longest transaction:           19.99
Shortest transaction:           0.60
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    162 hits
Availability:                 100.00 %
Elapsed time:                  29.13 secs
Data transferred:               1.14 MB
Response time:                  1.50 secs
Transaction rate:               5.56 trans/sec
Throughput:                     0.04 MB/sec
Concurrency:                    8.35
Successful transactions:         162
Failed transactions:               0
Longest transaction:            8.85
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    165 hits
Availability:                 100.00 %
Elapsed time:                  29.77 secs
Data transferred:               1.07 MB
Response time:                  3.08 secs
Transaction rate:               5.54 trans/sec
Throughput:                     0.04 MB/sec
Concurrency:                   17.06
Successful transactions:         165
Failed transactions:               0
Longest transaction:           10.86
Shortest transaction:           0.05
</code></pre>

<h5 id="toc_29">Benchmarking 2048 bit RSA key with 1 HSM (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     35 hits
Availability:                 100.00 %
Elapsed time:                  29.01 secs
Data transferred:               0.00 MB
Response time:                  1.23 secs
Transaction rate:               1.21 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.49
Successful transactions:          35
Failed transactions:               0
Longest transaction:            3.48
Shortest transaction:           0.66
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     45 hits
Availability:                 100.00 %
Elapsed time:                  29.92 secs
Data transferred:               0.00 MB
Response time:                  3.79 secs
Transaction rate:               1.50 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    5.70
Successful transactions:          45
Failed transactions:               0
Longest transaction:           17.70
Shortest transaction:           0.68
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     44 hits
Availability:                 100.00 %
Elapsed time:                  29.15 secs
Data transferred:               0.00 MB
Response time:                  8.83 secs
Transaction rate:               1.51 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   13.32
Successful transactions:          44
Failed transactions:               0
Longest transaction:           27.20
Shortest transaction:           0.69
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     42 hits
Availability:                 100.00 %
Elapsed time:                  29.35 secs
Data transferred:               0.00 MB
Response time:                 12.53 secs
Transaction rate:               1.43 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   17.94
Successful transactions:          42
Failed transactions:               0
Longest transaction:           28.97
Shortest transaction:           0.00
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     49 hits
Availability:                 100.00 %
Elapsed time:                  29.24 secs
Data transferred:               0.24 MB
Response time:                  4.40 secs
Transaction rate:               1.68 trans/sec
Throughput:                     0.01 MB/sec
Concurrency:                    7.37
Successful transactions:          49
Failed transactions:               0
Longest transaction:           24.25
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     46 hits
Availability:                 100.00 %
Elapsed time:                  29.98 secs
Data transferred:               0.13 MB
Response time:                  9.63 secs
Transaction rate:               1.53 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   14.77
Successful transactions:          46
Failed transactions:               0
Longest transaction:           29.81
Shortest transaction:           0.05
</code></pre>

<h5 id="toc_30">Benchmarking EC prime256v1 key with 1 HSM (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     52 hits
Availability:                 100.00 %
Elapsed time:                  29.95 secs
Data transferred:               0.00 MB
Response time:                  0.48 secs
Transaction rate:               1.74 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.84
Successful transactions:          52
Failed transactions:               0
Longest transaction:            1.91
Shortest transaction:           0.27
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     92 hits
Availability:                 100.00 %
Elapsed time:                  29.49 secs
Data transferred:               0.00 MB
Response time:                  1.01 secs
Transaction rate:               3.12 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.16
Successful transactions:          92
Failed transactions:               0
Longest transaction:            4.65
Shortest transaction:           0.27
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    103 hits
Availability:                 100.00 %
Elapsed time:                  29.96 secs
Data transferred:               0.00 MB
Response time:                  3.35 secs
Transaction rate:               3.44 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   11.53
Successful transactions:         103
Failed transactions:               0
Longest transaction:            8.37
Shortest transaction:           0.28
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     97 hits
Availability:                 100.00 %
Elapsed time:                  29.90 secs
Data transferred:               0.00 MB
Response time:                 10.76 secs
Transaction rate:               3.24 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   34.89
Successful transactions:          97
Failed transactions:               0
Longest transaction:           29.19
Shortest transaction:           0.00
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    120 hits
Availability:                 100.00 %
Elapsed time:                  29.84 secs
Data transferred:               0.80 MB
Response time:                  2.11 secs
Transaction rate:               4.02 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                    8.49
Successful transactions:         120
Failed transactions:               0
Longest transaction:            8.04
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    116 hits
Availability:                 100.00 %
Elapsed time:                  29.87 secs
Data transferred:               0.59 MB
Response time:                  4.25 secs
Transaction rate:               3.88 trans/sec
Throughput:                     0.02 MB/sec
Concurrency:                   16.52
Successful transactions:         116
Failed transactions:               0
Longest transaction:           14.15
Shortest transaction:           0.05
</code></pre>

<h4 id="toc_31">2 HSM&#39;s (OpenSC)</h4>

<h5 id="toc_32">Benchmarking 1024 bit RSA key with 2 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     51 hits
Availability:                 100.00 %
Elapsed time:                  29.17 secs
Data transferred:               0.00 MB
Response time:                  0.28 secs
Transaction rate:               1.75 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.49
Successful transactions:          51
Failed transactions:               0
Longest transaction:            1.06
Shortest transaction:           0.22
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    107 hits
Availability:                 100.00 %
Elapsed time:                  29.23 secs
Data transferred:               0.00 MB
Response time:                  0.30 secs
Transaction rate:               3.66 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.09
Successful transactions:         107
Failed transactions:               0
Longest transaction:            1.31
Shortest transaction:           0.22
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    217 hits
Availability:                 100.00 %
Elapsed time:                  29.96 secs
Data transferred:               0.00 MB
Response time:                  0.58 secs
Transaction rate:               7.24 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    4.21
Successful transactions:         217
Failed transactions:               0
Longest transaction:            4.26
Shortest transaction:           0.22
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    277 hits
Availability:                 100.00 %
Elapsed time:                  29.72 secs
Data transferred:               0.00 MB
Response time:                  5.66 secs
Transaction rate:               9.32 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   52.77
Successful transactions:         277
Failed transactions:               0
Longest transaction:           18.27
Shortest transaction:           0.47
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    286 hits
Availability:                 100.00 %
Elapsed time:                  29.76 secs
Data transferred:               2.04 MB
Response time:                  0.78 secs
Transaction rate:               9.61 trans/sec
Throughput:                     0.07 MB/sec
Concurrency:                    7.45
Successful transactions:         286
Failed transactions:               0
Longest transaction:            4.67
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    298 hits
Availability:                 100.00 %
Elapsed time:                  29.12 secs
Data transferred:               2.04 MB
Response time:                  1.51 secs
Transaction rate:              10.23 trans/sec
Throughput:                     0.07 MB/sec
Concurrency:                   15.49
Successful transactions:         298
Failed transactions:               0
Longest transaction:            9.48
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_33">Benchmarking 2048 bit RSA key with 2 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     47 hits
Availability:                 100.00 %
Elapsed time:                  29.00 secs
Data transferred:               0.00 MB
Response time:                  1.01 secs
Transaction rate:               1.62 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.63
Successful transactions:          47
Failed transactions:               0
Longest transaction:            3.08
Shortest transaction:           0.66
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     75 hits
Availability:                 100.00 %
Elapsed time:                  29.05 secs
Data transferred:               0.00 MB
Response time:                  1.58 secs
Transaction rate:               2.58 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    4.07
Successful transactions:          75
Failed transactions:               0
Longest transaction:            7.71
Shortest transaction:           0.66
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     82 hits
Availability:                 100.00 %
Elapsed time:                  29.74 secs
Data transferred:               0.00 MB
Response time:                  4.25 secs
Transaction rate:               2.76 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   11.72
Successful transactions:          82
Failed transactions:               0
Longest transaction:           17.67
Shortest transaction:           0.67
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     46 hits
Availability:                 100.00 %
Elapsed time:                  29.11 secs
Data transferred:               0.00 MB
Response time:                 15.96 secs
Transaction rate:               1.58 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   25.22
Successful transactions:          46
Failed transactions:               0
Longest transaction:           28.88
Shortest transaction:           2.22
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     92 hits
Availability:                 100.00 %
Elapsed time:                  29.44 secs
Data transferred:               0.61 MB
Response time:                  2.61 secs
Transaction rate:               3.12 trans/sec
Throughput:                     0.02 MB/sec
Concurrency:                    8.16
Successful transactions:          92
Failed transactions:               0
Longest transaction:           13.43
Shortest transaction:           0.05
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     75 hits
Availability:                 100.00 %
Elapsed time:                  29.60 secs
Data transferred:               0.41 MB
Response time:                  5.35 secs
Transaction rate:               2.53 trans/sec
Throughput:                     0.01 MB/sec
Concurrency:                   13.56
Successful transactions:          75
Failed transactions:               0
Longest transaction:           21.47
Shortest transaction:           0.00
</code></pre>

<h5 id="toc_34">Benchmarking EC prime256v1 key with 2 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     60 hits
Availability:                 100.00 %
Elapsed time:                  29.30 secs
Data transferred:               0.00 MB
Response time:                  0.31 secs
Transaction rate:               2.05 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.64
Successful transactions:          60
Failed transactions:               0
Longest transaction:            1.09
Shortest transaction:           0.26
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    106 hits
Availability:                 100.00 %
Elapsed time:                  29.71 secs
Data transferred:               0.00 MB
Response time:                  0.42 secs
Transaction rate:               3.57 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.50
Successful transactions:         106
Failed transactions:               0
Longest transaction:            1.58
Shortest transaction:           0.26
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    184 hits
Availability:                 100.00 %
Elapsed time:                  29.61 secs
Data transferred:               0.00 MB
Response time:                  0.80 secs
Transaction rate:               6.21 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    4.99
Successful transactions:         184
Failed transactions:               0
Longest transaction:            4.12
Shortest transaction:           0.26  
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    201 hits
Availability:                 100.00 %
Elapsed time:                  29.50 secs
Data transferred:               0.00 MB
Response time:                  5.56 secs
Transaction rate:               6.81 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   37.90
Successful transactions:         201
Failed transactions:               0
Longest transaction:           27.49
Shortest transaction:           0.26
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    237 hits
Availability:                 100.00 %
Elapsed time:                  29.56 secs
Data transferred:               1.69 MB
Response time:                  0.90 secs
Transaction rate:               8.02 trans/sec
Throughput:                     0.06 MB/sec
Concurrency:                    7.25
Successful transactions:         237
Failed transactions:               0
Longest transaction:            4.72
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    240 hits
Availability:                 100.00 %
Elapsed time:                  29.28 secs
Data transferred:               1.67 MB
Response time:                  2.08 secs
Transaction rate:               8.20 trans/sec
Throughput:                     0.06 MB/sec
Concurrency:                   17.03
Successful transactions:         240
Failed transactions:               0
Longest transaction:            7.64
Shortest transaction:           0.04
</code></pre>

<h4 id="toc_35">3 HSM&#39;s (OpenSC)</h4>

<h5 id="toc_36">Benchmarking 1024 bit RSA key with 3 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     54 hits
Availability:                 100.00 %
Elapsed time:                  29.88 secs
Data transferred:               0.00 MB
Response time:                  0.25 secs
Transaction rate:               1.81 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.46
Successful transactions:          54
Failed transactions:               0
Longest transaction:            0.66
Shortest transaction:           0.22
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    118 hits
Availability:                 100.00 %
Elapsed time:                  29.72 secs
Data transferred:               0.00 MB
Response time:                  0.28 secs
Transaction rate:               3.97 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.12
Successful transactions:         118
Failed transactions:               0
Longest transaction:            1.66
Shortest transaction:           0.22 
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    205 hits
Availability:                 100.00 %
Elapsed time:                  29.85 secs
Data transferred:               0.00 MB
Response time:                  0.32 secs
Transaction rate:               6.87 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    2.19
Successful transactions:         206
Failed transactions:               0
Longest transaction:            1.69
Shortest transaction:           0.22
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    407 hits
Availability:                 100.00 %
Elapsed time:                  29.07 secs
Data transferred:               0.01 MB
Response time:                  3.65 secs
Transaction rate:              14.00 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   51.11
Successful transactions:         407
Failed transactions:               0
Longest transaction:           17.38
Shortest transaction:           0.25
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    382 hits
Availability:                 100.00 %
Elapsed time:                  29.48 secs
Data transferred:               2.73 MB
Response time:                  0.40 secs
Transaction rate:              12.96 trans/sec
Throughput:                     0.09 MB/sec
Concurrency:                    5.22
Successful transactions:         382
Failed transactions:               0
Longest transaction:            1.99
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    449 hits
Availability:                 100.00 %
Elapsed time:                  29.31 secs
Data transferred:               3.18 MB
Response time:                  0.99 secs
Transaction rate:              15.32 trans/sec
Throughput:                     0.11 MB/sec
Concurrency:                   15.12
Successful transactions:         449
Failed transactions:               0
Longest transaction:            6.49
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_37">Benchmarking 2048 bit RSA key with 3 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     44 hits
Availability:                 100.00 %
Elapsed time:                  29.10 secs
Data transferred:               0.00 MB
Response time:                  0.75 secs
Transaction rate:               1.51 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.13
Successful transactions:          44
Failed transactions:               0
Longest transaction:            1.50
Shortest transaction:           0.66
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     89 hits
Availability:                 100.00 %
Elapsed time:                  29.34 secs
Data transferred:               0.00 MB
Response time:                  0.90 secs
Transaction rate:               3.03 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    2.72
Successful transactions:          89
Failed transactions:               0
Longest transaction:            2.67
Shortest transaction:           0.66
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    127 hits
Availability:                 100.00 %
Elapsed time:                  29.99 secs
Data transferred:               0.00 MB
Response time:                  2.05 secs
Transaction rate:               4.23 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    8.69
Successful transactions:         127
Failed transactions:               0
Longest transaction:           11.20
Shortest transaction:           0.66
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    128 hits
Availability:                 100.00 %
Elapsed time:                  29.53 secs
Data transferred:               0.00 MB
Response time:                  9.24 secs
Transaction rate:               4.33 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   40.07
Successful transactions:         128
Failed transactions:               0
Longest transaction:           23.46
Shortest transaction:           0.66
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    139 hits
Availability:                 100.00 %
Elapsed time:                  29.43 secs
Data transferred:               0.97 MB
Response time:                  1.79 secs
Transaction rate:               4.72 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                    8.48
Successful transactions:         139
Failed transactions:               0
Longest transaction:           11.38
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    140 hits
Availability:                 100.00 %
Elapsed time:                  29.39 secs
Data transferred:               0.89 MB
Response time:                  3.58 secs
Transaction rate:               4.76 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                   17.04
Successful transactions:         140
Failed transactions:               0
Longest transaction:           21.96
Shortest transaction:           0.05
</code></pre>

<h5 id="toc_38">Benchmarking EC prime256v1 key with 3 HSM&#39;s (OpenSC)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     51 hits
Availability:                 100.00 %
Elapsed time:                  29.73 secs
Data transferred:               0.00 MB
Response time:                  0.31 secs
Transaction rate:               1.72 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.53
Successful transactions:          51
Failed transactions:               0
Longest transaction:            0.67
Shortest transaction:           0.25    
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    110 hits
Availability:                 100.00 %
Elapsed time:                  29.41 secs
Data transferred:               0.00 MB
Response time:                  0.34 secs
Transaction rate:               3.74 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.26
Successful transactions:         110
Failed transactions:               0
Longest transaction:            1.29
Shortest transaction:           0.25
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    221 hits
Availability:                 100.00 %
Elapsed time:                  29.82 secs
Data transferred:               0.00 MB
Response time:                  0.44 secs
Transaction rate:               7.41 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.24
Successful transactions:         221
Failed transactions:               0
Longest transaction:            2.12
Shortest transaction:           0.24
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    331 hits
Availability:                 100.00 %
Elapsed time:                  29.64 secs
Data transferred:               0.00 MB
Response time:                  4.29 secs
Transaction rate:              11.17 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   47.90
Successful transactions:         331
Failed transactions:               0
Longest transaction:           25.01
Shortest transaction:           0.25
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    336 hits
Availability:                 100.00 %
Elapsed time:                  29.48 secs
Data transferred:               2.42 MB
Response time:                  0.54 secs
Transaction rate:              11.40 trans/sec
Throughput:                     0.08 MB/sec
Concurrency:                    6.10
Successful transactions:         336
Failed transactions:               0
Longest transaction:            2.70
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    377 hits
Availability:                 100.00 %
Elapsed time:                  29.86 secs
Data transferred:               2.59 MB
Response time:                  1.21 secs
Transaction rate:              12.63 trans/sec
Throughput:                     0.09 MB/sec
Concurrency:                   15.27
Successful transactions:         377
Failed transactions:               0
Longest transaction:            5.02
Shortest transaction:           0.04
</code></pre>

<h3 id="toc_39">sc-hsm-embedded benchmarks</h3>

<p>The below benchmarks utilize the read only <code>libsc-hsm-embedded</code> module with
<code>mod_nss</code>. Read more on the <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">sc-hsm-embedded</a> module here.</p>

<p>This module is targeted at embedded use in devices, but can also be used
regularly. I recommend it over the OpenSC module, since in production you don&#39;t
want to be able to write to the HSM. You should have a seperate, non-networked
workstation for that.</p>

<h4 id="toc_40">1 HSM (sc-hsm-embedded)</h4>

<h5 id="toc_41">Benchmarking 1024 bit RSA key with 1 HSM (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     56 hits
Availability:                 100.00 %
Elapsed time:                  29.48 secs
Data transferred:               0.00 MB
Response time:                  0.31 secs
Transaction rate:               1.90 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.60
Successful transactions:          56
Failed transactions:               0
Longest transaction:            1.13
Shortest transaction:           0.24
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    100 hits
Availability:                 100.00 %
Elapsed time:                  29.18 secs
Data transferred:               0.00 MB
Response time:                  0.52 secs
Transaction rate:               3.43 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.78
Successful transactions:         100
Failed transactions:               0
Longest transaction:            2.24
Shortest transaction:           0.24
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    131 hits
Availability:                 100.00 %
Elapsed time:                  29.17 secs
Data transferred:               0.00 MB
Response time:                  2.04 secs
Transaction rate:               4.49 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    9.17
Successful transactions:         131
Failed transactions:               0
Longest transaction:            6.56
Shortest transaction:           0.28
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    124 hits
Availability:                 100.00 %
Elapsed time:                  29.50 secs
Data transferred:               0.00 MB
Response time:                 10.24 secs
Transaction rate:               4.20 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   43.03
Successful transactions:         124
Failed transactions:               0
Longest transaction:           19.99
Shortest transaction:           0.94
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    148 hits
Availability:                 100.00 %
Elapsed time:                  29.63 secs
Data transferred:               1.02 MB
Response time:                  1.68 secs
Transaction rate:               4.99 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                    8.39
Successful transactions:         148
Failed transactions:               0
Longest transaction:            5.48
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    144 hits
Availability:                 100.00 %
Elapsed time:                  29.12 secs
Data transferred:               0.98 MB
Response time:                  3.63 secs
Transaction rate:               4.95 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                   17.94
Successful transactions:         144
Failed transactions:               0
Longest transaction:           11.69
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_42">Benchmarking 2048 bit RSA key with 1 HSM (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     36 hits
Availability:                 100.00 %
Elapsed time:                  29.78 secs
Data transferred:               0.00 MB
Response time:                  1.59 secs
Transaction rate:               1.21 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.93
Successful transactions:          36
Failed transactions:               0
Longest transaction:            3.89
Shortest transaction:           0.67
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     44 hits
Availability:                 100.00 %
Elapsed time:                  29.19 secs
Data transferred:               0.00 MB
Response time:                  4.21 secs
Transaction rate:               1.51 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    6.34
Successful transactions:          44
Failed transactions:               0
Longest transaction:            9.43
Shortest transaction:           0.68
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     39 hits
Availability:                 100.00 %
Elapsed time:                  29.06 secs
Data transferred:               0.00 MB
Response time:                  9.92 secs
Transaction rate:               1.34 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   13.32
Successful transactions:          39
Failed transactions:               0
Longest transaction:           16.25
Shortest transaction:           1.60
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     23 hits
Availability:                 100.00 %
Elapsed time:                  29.82 secs
Data transferred:               0.00 MB
Response time:                 17.65 secs
Transaction rate:               0.77 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   13.61
Successful transactions:          23
Failed transactions:               0
Longest transaction:           29.12
Shortest transaction:           0.00
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     40 hits
Availability:                 100.00 %
Elapsed time:                  29.75 secs
Data transferred:               0.17 MB
Response time:                  6.87 secs
Transaction rate:               1.34 trans/sec
Throughput:                     0.01 MB/sec
Concurrency:                    9.23
Successful transactions:          40
Failed transactions:               0
Longest transaction:           16.12
Shortest transaction:           1.66
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     33 hits
Availability:                 100.00 %
Elapsed time:                  29.01 secs
Data transferred:               0.07 MB
Response time:                 11.64 secs
Transaction rate:               1.14 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   13.24
Successful transactions:          33
Failed transactions:               0
Longest transaction:           26.08
Shortest transaction:           3.18
</code></pre>

<h5 id="toc_43">Benchmarking EC prime256v1 key with 1 HSM (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     59 hits
Availability:                 100.00 %
Elapsed time:                  29.15 secs
Data transferred:               0.00 MB
Response time:                  0.37 secs
Transaction rate:               2.02 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.75
Successful transactions:          59
Failed transactions:               0
Longest transaction:            1.22
Shortest transaction:           0.25
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    103 hits
Availability:                 100.00 %
Elapsed time:                  29.67 secs
Data transferred:               0.00 MB
Response time:                  0.57 secs
Transaction rate:               3.47 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.98
Successful transactions:         103
Failed transactions:               0
Longest transaction:            2.86
Shortest transaction:           0.25
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    122 hits
Availability:                 100.00 %
Elapsed time:                  29.85 secs
Data transferred:               0.00 MB
Response time:                  2.10 secs
Transaction rate:               4.09 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    8.59
Successful transactions:         122
Failed transactions:               0
Longest transaction:            6.55
Shortest transaction:           0.30
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    109 hits
Availability:                 100.00 %
Elapsed time:                  29.45 secs
Data transferred:               0.00 MB
Response time:                 11.17 secs
Transaction rate:               3.70 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   41.33
Successful transactions:         109
Failed transactions:               0
Longest transaction:           23.97
Shortest transaction:           0.52
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    137 hits
Availability:                 100.00 %
Elapsed time:                  29.04 secs
Data transferred:               0.93 MB
Response time:                  1.68 secs
Transaction rate:               4.72 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                    7.94
Successful transactions:         137
Failed transactions:               0
Longest transaction:            4.49
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    138 hits
Availability:                 100.00 %
Elapsed time:                  29.64 secs
Data transferred:               0.95 MB
Response time:                  3.96 secs
Transaction rate:               4.66 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                   18.44
Successful transactions:         138
Failed transactions:               0
Longest transaction:           12.19
Shortest transaction:           0.05
</code></pre>

<h4 id="toc_44">2 HSM&#39;s (sc-hsm-embedded)</h4>

<h5 id="toc_45">Benchmarking 1024 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     59 hits
Availability:                 100.00 %
Elapsed time:                  29.34 secs
Data transferred:               0.00 MB
Response time:                  0.26 secs
Transaction rate:               2.01 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.52
Successful transactions:          59
Failed transactions:               0
Longest transaction:            0.62
Shortest transaction:           0.22
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    109 hits
Availability:                 100.00 %
Elapsed time:                  29.04 secs
Data transferred:               0.00 MB
Response time:                  0.29 secs
Transaction rate:               3.75 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.10
Successful transactions:         109
Failed transactions:               0
Longest transaction:            1.13
Shortest transaction:           0.22
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    211 hits
Availability:                 100.00 %
Elapsed time:                  29.36 secs
Data transferred:               0.00 MB
Response time:                  0.42 secs
Transaction rate:               7.19 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.01
Successful transactions:         211
Failed transactions:               0
Longest transaction:            2.45
Shortest transaction:           0.22
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    253 hits
Availability:                 100.00 %
Elapsed time:                  29.04 secs
Data transferred:               0.00 MB
Response time:                  5.24 secs
Transaction rate:               8.71 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   45.62
Successful transactions:         253
Failed transactions:               0
Longest transaction:           18.60
Shortest transaction:           0.25
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    308 hits
Availability:                 100.00 %
Elapsed time:                  29.22 secs
Data transferred:               2.20 MB
Response time:                  0.61 secs
Transaction rate:              10.54 trans/sec
Throughput:                     0.08 MB/sec
Concurrency:                    6.39
Successful transactions:         308
Failed transactions:               0
Longest transaction:            2.29
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    318 hits
Availability:                 100.00 %
Elapsed time:                  29.94 secs
Data transferred:               2.21 MB
Response time:                  1.53 secs
Transaction rate:              10.62 trans/sec
Throughput:                     0.07 MB/sec
Concurrency:                   16.23
Successful transactions:         318
Failed transactions:               0
Longest transaction:            7.03
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_46">Benchmarking 2048 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     47 hits
Availability:                 100.00 %
Elapsed time:                  29.86 secs
Data transferred:               0.00 MB
Response time:                  0.82 secs
Transaction rate:               1.57 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.29
Successful transactions:          47
Failed transactions:               0
Longest transaction:            1.93
Shortest transaction:           0.66
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     74 hits
Availability:                 100.00 %
Elapsed time:                  29.90 secs
Data transferred:               0.00 MB
Response time:                  1.50 secs
Transaction rate:               2.47 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.71
Successful transactions:          74
Failed transactions:               0
Longest transaction:            4.43
Shortest transaction:           0.66
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     84 hits
Availability:                 100.00 %
Elapsed time:                  29.03 secs
Data transferred:               0.00 MB
Response time:                  4.29 secs
Transaction rate:               2.89 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   12.42
Successful transactions:          84
Failed transactions:               0
Longest transaction:           14.70
Shortest transaction:           0.69
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     72 hits
Availability:                 100.00 %
Elapsed time:                  29.87 secs
Data transferred:               0.00 MB
Response time:                 13.06 secs
Transaction rate:               2.41 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   31.48
Successful transactions:          72
Failed transactions:               0
Longest transaction:           27.91
Shortest transaction:           2.27
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     95 hits
Availability:                 100.00 %
Elapsed time:                  29.51 secs
Data transferred:               0.60 MB
Response time:                  2.75 secs
Transaction rate:               3.22 trans/sec
Throughput:                     0.02 MB/sec
Concurrency:                    8.86
Successful transactions:          95
Failed transactions:               0
Longest transaction:            8.09
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     87 hits
Availability:                 100.00 %
Elapsed time:                  29.89 secs
Data transferred:               0.41 MB
Response time:                  6.08 secs
Transaction rate:               2.91 trans/sec
Throughput:                     0.01 MB/sec
Concurrency:                   17.70
Successful transactions:          87
Failed transactions:               0
Longest transaction:           17.31
Shortest transaction:           0.05
</code></pre>

<h5 id="toc_47">Benchmarking EC prime256v1 key with 2 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     59 hits
Availability:                 100.00 %
Elapsed time:                  29.14 secs
Data transferred:               0.00 MB
Response time:                  0.29 secs
Transaction rate:               2.02 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.59
Successful transactions:          59
Failed transactions:               0
Longest transaction:            0.71
Shortest transaction:           0.24
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     98 hits
Availability:                 100.00 %
Elapsed time:                  29.19 secs
Data transferred:               0.00 MB
Response time:                  0.34 secs
Transaction rate:               3.36 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.13
Successful transactions:          98
Failed transactions:               0
Longest transaction:            1.20
Shortest transaction:           0.24
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    217 hits
Availability:                 100.00 %
Elapsed time:                  29.94 secs
Data transferred:               0.00 MB
Response time:                  0.52 secs
Transaction rate:               7.25 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.78
Successful transactions:         217
Failed transactions:               0
Longest transaction:            2.39
Shortest transaction:           0.24
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    232 hits
Availability:                 100.00 %
Elapsed time:                  29.22 secs
Data transferred:               0.00 MB
Response time:                  5.62 secs
Transaction rate:               7.94 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   44.64
Successful transactions:         232
Failed transactions:               0
Longest transaction:           20.16
Shortest transaction:           0.27
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    276 hits
Availability:                 100.00 %
Elapsed time:                  29.35 secs
Data transferred:               1.92 MB
Response time:                  0.72 secs
Transaction rate:               9.40 trans/sec
Throughput:                     0.07 MB/sec
Concurrency:                    6.74
Successful transactions:         276
Failed transactions:               0
Longest transaction:            2.42
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    288 hits
Availability:                 100.00 %
Elapsed time:                  29.86 secs
Data transferred:               1.94 MB
Response time:                  1.77 secs
Transaction rate:               9.65 trans/sec
Throughput:                     0.06 MB/sec
Concurrency:                   17.08
Successful transactions:         288
Failed transactions:               0
Longest transaction:            8.33
Shortest transaction:           0.04
</code></pre>

<h4 id="toc_48">3 HSM&#39;s (sc-hsm-embedded)</h4>

<h5 id="toc_49">Benchmarking 1024 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     55 hits
Availability:                 100.00 %
Elapsed time:                  29.81 secs
Data transferred:               0.00 MB
Response time:                  0.24 secs
Transaction rate:               1.85 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.45
Successful transactions:          55
Failed transactions:               0
Longest transaction:            0.47
Shortest transaction:           0.22
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    116 hits
Availability:                 100.00 %
Elapsed time:                  29.33 secs
Data transferred:               0.00 MB
Response time:                  0.26 secs
Transaction rate:               3.95 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.05
Successful transactions:         116
Failed transactions:               0
Longest transaction:            0.81
Shortest transaction:           0.22
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    227 hits
Availability:                 100.00 %
Elapsed time:                  29.82 secs
Data transferred:               0.00 MB
Response time:                  0.31 secs
Transaction rate:               7.61 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    2.39
Successful transactions:         227
Failed transactions:               0
Longest transaction:            1.58
Shortest transaction:           0.22
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    420 hits
Availability:                 100.00 %
Elapsed time:                  29.90 secs
Data transferred:               0.01 MB
Response time:                  3.79 secs
Transaction rate:              14.05 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   53.27
Successful transactions:         420
Failed transactions:               0
Longest transaction:           20.31
Shortest transaction:           0.27
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    430 hits
Availability:                 100.00 %
Elapsed time:                  29.46 secs
Data transferred:               3.11 MB
Response time:                  0.37 secs
Transaction rate:              14.60 trans/sec
Throughput:                     0.11 MB/sec
Concurrency:                    5.38
Successful transactions:         430
Failed transactions:               0
Longest transaction:            1.96
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    494 hits
Availability:                 100.00 %
Elapsed time:                  29.72 secs
Data transferred:               3.49 MB
Response time:                  0.87 secs
Transaction rate:              16.62 trans/sec
Throughput:                     0.12 MB/sec
Concurrency:                   14.43
Successful transactions:         494
Failed transactions:               0
Longest transaction:            3.93
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_50">Benchmarking 2048 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     50 hits
Availability:                 100.00 %
Elapsed time:                  29.58 secs
Data transferred:               0.00 MB
Response time:                  0.73 secs
Transaction rate:               1.69 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.23
Successful transactions:          50
Failed transactions:               0
Longest transaction:            1.50
Shortest transaction:           0.66
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     99 hits
Availability:                 100.00 %
Elapsed time:                  29.82 secs
Data transferred:               0.00 MB
Response time:                  0.91 secs
Transaction rate:               3.32 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    3.01
Successful transactions:          99
Failed transactions:               0
Longest transaction:            2.97
Shortest transaction:           0.66
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    126 hits
Availability:                 100.00 %
Elapsed time:                  29.85 secs
Data transferred:               0.00 MB
Response time:                  2.22 secs
Transaction rate:               4.22 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    9.35
Successful transactions:         126
Failed transactions:               0
Longest transaction:            7.04
Shortest transaction:           0.66     
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    118 hits
Availability:                 100.00 %
Elapsed time:                  29.28 secs
Data transferred:               0.00 MB
Response time:                 10.28 secs
Transaction rate:               4.03 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   41.44
Successful transactions:         118
Failed transactions:               0
Longest transaction:           29.13
Shortest transaction:           0.66    
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    141 hits
Availability:                 100.00 %
Elapsed time:                  29.05 secs
Data transferred:               1.00 MB
Response time:                  1.74 secs
Transaction rate:               4.85 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                    8.44
Successful transactions:         141
Failed transactions:               0
Longest transaction:            4.63
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    145 hits
Availability:                 100.00 %
Elapsed time:                  29.27 secs
Data transferred:               1.01 MB
Response time:                  3.57 secs
Transaction rate:               4.95 trans/sec
Throughput:                     0.03 MB/sec
Concurrency:                   17.70
Successful transactions:         145
Failed transactions:               0
Longest transaction:           12.44
Shortest transaction:           0.04
</code></pre>

<h5 id="toc_51">Benchmarking EC prime256v1 key with 3 HSM&#39;s (sc-hsm-embedded)</h5>

<p>A siege test with 5 concurrent users, 30 seconds:</p>

<pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                     57 hits
Availability:                 100.00 %
Elapsed time:                  29.41 secs
Data transferred:               0.00 MB
Response time:                  0.29 secs
Transaction rate:               1.94 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    0.56
Successful transactions:          57
Failed transactions:               0
Longest transaction:            0.56
Shortest transaction:           0.24
</code></pre>

<p>10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    104 hits
Availability:                 100.00 %
Elapsed time:                  29.02 secs
Data transferred:               0.00 MB
Response time:                  0.31 secs
Transaction rate:               3.58 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    1.11
Successful transactions:         104
Failed transactions:               0
Longest transaction:            0.94
Shortest transaction:           0.25
</code></pre>

<p>20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    220 hits
Availability:                 100.00 %
Elapsed time:                  29.82 secs
Data transferred:               0.00 MB
Response time:                  0.40 secs
Transaction rate:               7.38 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                    2.97
Successful transactions:         220
Failed transactions:               0
Longest transaction:            2.16
Shortest transaction:           0.25
</code></pre>

<p>60 benchmark mode:</p>

<pre><code>siege -c60 -b -t30S https://hsmcluster.nl
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    360 hits
Availability:                 100.00 %
Elapsed time:                  29.99 secs
Data transferred:               0.00 MB
Response time:                  4.34 secs
Transaction rate:              12.00 trans/sec
Throughput:                     0.00 MB/sec
Concurrency:                   52.12
Successful transactions:         360
Failed transactions:               0
Longest transaction:           18.87
Shortest transaction:           0.30    
</code></pre>

<p>Wordpress site with 10 concurrent users:</p>

<pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    382 hits
Availability:                 100.00 %
Elapsed time:                  29.57 secs
Data transferred:               2.77 MB
Response time:                  0.45 secs
Transaction rate:              12.92 trans/sec
Throughput:                     0.09 MB/sec
Concurrency:                    5.86
Successful transactions:         382
Failed transactions:               0
Longest transaction:            2.32
Shortest transaction:           0.04
</code></pre>

<p>Wordpress site with 20 concurrent users:</p>

<pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;
</code></pre>

<p>Result:</p>

<pre><code>Transactions:                    427 hits
Availability:                 100.00 %
Elapsed time:                  29.96 secs
Data transferred:               2.90 MB
Response time:                  1.11 secs
Transaction rate:              14.25 trans/sec
Throughput:                     0.10 MB/sec
Concurrency:                   15.83
Successful transactions:         427
Failed transactions:               0
Longest transaction:            3.71
Shortest transaction:           0.04
</code></pre>
Tags: <a href="../tags/apache.html">apache</a>
, <a href="../tags/articles.html">articles</a>
, <a href="../tags/cluster.html">cluster</a>
, <a href="../tags/cryptoki.html">cryptoki</a>
, <a href="../tags/haproxy.html">haproxy</a>
, <a href="../tags/hsm.html">hsm</a>
, <a href="../tags/mod_nss.html">mod_nss</a>
, <a href="../tags/nginx.html">nginx</a>
, <a href="../tags/nitrokey.html">nitrokey</a>
, <a href="../tags/nitrokey-hsm.html">nitrokey-hsm</a>
, <a href="../tags/openssl.html">openssl</a>
, <a href="../tags/pkcs11.html">pkcs11</a>
, <a href="../tags/safenet.html">safenet</a>
, <a href="../tags/smartcard.html">smartcard</a>
, <a href="../tags/smartcard-hsm.html">smartcard-hsm</a>
</div></main>
<br/>
<footer>
<br>
                <p><small>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a>.</small>
                </p>
    
    </footer>
    <script data-goatcounter="https://raymii.goatcounter.com/count"
            async src="//gc.zgo.at/count.js"></script>

    <script defer src="/s/inc/js/instant.5.2.0.js"  type="module" ></script>

     
    </main>
    </body>
    </html>
    