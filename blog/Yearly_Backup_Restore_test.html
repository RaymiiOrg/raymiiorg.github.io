
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>The yearly backup restore test - Raymii.org</title>
        <style> *, ::before, ::after {background-repeat: no-repeat;-webkit-box-sizing: border-box;box-sizing: border-box;}::before, ::after {text-decoration: inherit;vertical-align: inherit;}html {cursor: default;font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";line-height: 1.15;-moz-tab-size: 4;-o-tab-size: 4;tab-size: 4;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;word-break: break-word;}body {background-color: white;margin: 0;}h1 {font-size: 2em;margin: 0.67em 0;}hr {height: 0;overflow: visible;}main {display: block;}nav ol, nav ul {list-style: none;}pre {font-family: Roboto Mono, Menlo, Consolas, Ubuntu Monospace, Noto Mono, Oxygen Mono, Liberation Mono, monospace;font-size: 1em;}a {background-color: transparent;}abbr[title] {text-decoration: underline;-webkit-text-decoration: underline dotted;text-decoration: underline dotted;}b, strong {font-weight: bolder;}code, kbd, samp {font-family: Menlo, Consolas, Roboto Mono, Ubuntu Monospace, Noto Mono, Oxygen Mono, Liberation Mono, monospace;font-size: 1em;}small {font-size: 80%;}::-moz-selection {background-color: #b3d4fc;color: #000;text-shadow: none;}::selection {background-color: #b3d4fc;color: #000;text-shadow: none;}audio, canvas, iframe, img, svg, video {vertical-align: middle;}audio, video {display: inline-block;}audio:not([controls]) {display: none;height: 0;}img {border-style: none;}svg:not([fill]) {fill: currentColor;}svg:not(:root) {overflow: hidden;}table {border-collapse: collapse;}button, input, select, textarea {font-family: inherit;font-size: inherit;line-height: inherit;}button, input, select {margin: 0;}button {overflow: visible;text-transform: none;}button, [type="button"], [type="reset"], [type="submit"] {-webkit-appearance: button;}fieldset {padding: 0.35em 0.75em 0.625em;}input {overflow: visible;}legend {color: inherit;display: table;max-width: 100%;white-space: normal;}progress {display: inline-block;vertical-align: baseline;}select {text-transform: none;}textarea {margin: 0;overflow: auto;resize: vertical;}[type="checkbox"], [type="radio"] {padding: 0;}[type="search"] {-webkit-appearance: textfield;outline-offset: -2px;}::-webkit-inner-spin-button, ::-webkit-outer-spin-button {height: auto;}::-webkit-input-placeholder {color: inherit;opacity: 0.54;}::-webkit-search-decoration {-webkit-appearance: none;}::-webkit-file-upload-button {-webkit-appearance: button;font: inherit;}::-moz-focus-inner {border-style: none;padding: 0;}:-moz-focusring {outline: 1px dotted ButtonText;}details {display: block;}dialog {background-color: white;border: solid;color: black;display: block;height: -moz-fit-content;height: -webkit-fit-content;height: fit-content;left: 0;margin: auto;padding: 1em;position: absolute;right: 0;width: -moz-fit-content;width: -webkit-fit-content;width: fit-content;}dialog:not([open]) {display: none;}summary {display: list-item;}canvas {display: inline-block;}template {display: none;}a, area, button, input, label, select, summary, textarea, [tabindex] {-ms-touch-action: manipulation;touch-action: manipulation;}[hidden] {display: none;}[aria-busy="true"] {cursor: progress;}[aria-controls] {cursor: pointer;}[aria-disabled="true"], [disabled] {cursor: not-allowed;}[aria-hidden="false"][hidden]:not(:focus) {clip: rect(0, 0, 0, 0);display: inherit;position: absolute;}main, header, footer, article, section, aside, details, summary {margin: 0 auto;margin-bottom: 16px;width: 100%;}main {display: block;margin: 0 auto;max-width: 1000px;padding: 0 16px 16px;}footer {border-top: 1px solid rgba(0, 0, 0, 0.12);padding: 16px 0;text-align: left;}footer p {margin-bottom: 0;}hr {border: 0;border-top: 1px solid rgba(0, 0, 0, 0.12);display: block;margin-top: 16px;margin-bottom: 16px;width: 100%;-webkit-box-sizing: content-box;box-sizing: content-box;height: 0;overflow: visible;}img {height: auto;max-width: 100%;vertical-align: baseline;}@media screen and (max-width: 400px) {article, section, aside {clear: both;display: block;max-width: 100%;}img {margin-right: 16px;}}embed, iframe, video {border: 0;}body {color: rgba(0, 0, 0, 0.8);font-family: "Ubuntu", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.5;}p {margin: 0;margin-bottom: 16px;}h1, h2, h3, h4, h5, h6 {color: inherit;font-family: inherit;line-height: 1.2;font-weight: 500;}h1 {font-size: 40px;margin: 20px 0 16px;}h2 {font-size: 32px;margin: 20px 0 16px;}h3 {color: #75cc00;font-size: 28px;margin: 16px 0 4px;}h4 {color: #75cc00;font-size: 24px;margin: 16px 0 4px;}h5 {color: #75cc00;font-size: 20px;margin: 16px 0 4px;}h6 {color: #75cc00;font-size: 16px;margin: 16px 0 4px;}small {color: rgba(0, 0, 0, 0.54);vertical-align: bottom;}pre {background: #f7f7f9;color: rgba(0, 0, 0, 0.8);display: block;font-family: "Roboto Mono", Menlo, Monaco, Consolas, "Courier New", monospace;font-size: 16px;margin: 16px 0;padding: 16px;white-space: pre-wrap;overflow-wrap: break-word;}code {background: #f7f7f9;color: rgba(0, 0, 0, 0.8);font-family: "Roboto Mono", Menlo, Monaco, Consolas, "Courier New", monospace;font-size: 16px;line-height: inherit;margin: 0;vertical-align: baseline;word-break: break-all;word-wrap: break-word;}a {color: #75cc00;text-decoration: none;background-color: transparent;}a:hover, a:focus {color: #0062cc;font-weight: bolder;text-decoration: underline;}dl {margin-bottom: 16px;}dd {margin-left: 40px;}ul, ol {margin-bottom: 8px;padding-left: 40px;vertical-align: baseline;}blockquote {border-left: 2px solid rgba(0, 0, 0, 0.8);font-family: Georgia, Times, "Times New Roman", serif;font-style: italic;margin: 16px 0;padding-left: 16px;}figcaption {font-family: Georgia, Times, "Times New Roman", serif;}u {text-decoration: underline;}s {text-decoration: line-through;}sup {font-size: 14px;vertical-align: super;}sub {font-size: 14px;vertical-align: sub;}mark {background: #ffeb3b;}input[type="text"], input[type="password"], input[type="email"], input[type="url"], input[type="date"], input[type="month"], input[type="time"], input[type="datetime"], input[type="datetime-local"], input[type="week"], input[type="number"], input[type="search"], input[type="tel"], select, textarea {background: #fff;background-clip: padding-box;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;color: rgba(0, 0, 0, 0.8);display: block;width: 100%;padding: 8px 16px;line-height: 1.5;-webkit-transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}input[type="color"] {background: #fff;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;display: inline-block;vertical-align: middle;}input:not([type]) {-webkit-appearance: none;background: #fff;background-clip: padding-box;border: 1px solid rgba(0, 0, 0, 0.12);border-radius: 4px;color: rgba(0, 0, 0, 0.8);display: block;width: 100%;padding: 8px 16px;line-height: 1.5;-webkit-transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;text-align: left;}input[type="text"]:focus, input[type="password"]:focus, input[type="email"]:focus, input[type="url"]:focus, input[type="date"]:focus, input[type="month"]:focus, input[type="time"]:focus, input[type="datetime"]:focus, input[type="datetime-local"]:focus, input[type="week"]:focus, input[type="number"]:focus, input[type="search"]:focus, input[type="tel"]:focus, input[type="color"]:focus, select:focus, textarea:focus {background-color: #fff;border-color: #80bdff;outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);}input:not([type]):focus {background-color: #fff;border-color: #80bdff;outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);}input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus {outline: 1px thin rgba(0, 0, 0, 0.12);}input[type="text"][disabled], input[type="password"][disabled], input[type="email"][disabled], input[type="url"][disabled], input[type="date"][disabled], input[type="month"][disabled], input[type="time"][disabled], input[type="datetime"][disabled], input[type="datetime-local"][disabled], input[type="week"][disabled], input[type="number"][disabled], input[type="search"][disabled], input[type="tel"][disabled], input[type="color"][disabled], select[disabled], textarea[disabled] {background-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);cursor: not-allowed;opacity: 1;}input:not([type])[disabled] {background-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);cursor: not-allowed;opacity: 1;}input[readonly], select[readonly], textarea[readonly] {border-color: rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.54);}input:focus:invalid, textarea:focus:invalid, select:focus:invalid {border-color: #ea1c0d;color: #f44336;}input[type="file"]:focus:invalid:focus, input[type="radio"]:focus:invalid:focus, input[type="checkbox"]:focus:invalid:focus {outline-color: #f44336;}select {border: 1px solid rgba(0, 0, 0, 0.12);vertical-align: sub;}select:not([size]):not([multiple]) {height: -webkit-calc(2.25rem + 2px);height: calc(2.25rem + 2px);}select[multiple] {height: auto;}label {display: inline-block;line-height: 2;}fieldset {border: 0;margin: 0;padding: 8px 0;}legend {border-bottom: 1px solid rgba(0, 0, 0, 0.12);color: rgba(0, 0, 0, 0.8);display: block;margin-bottom: 8px;padding: 8px 0;width: 100%;}textarea {overflow: auto;resize: vertical;}input[type=checkbox], input[type=radio] {-webkit-box-sizing: border-box;box-sizing: border-box;padding: 0;display: inline;}input[type=submit], input[type=reset], input[type=button], button {background-color: #75cc00;border: #75cc00;border-radius: 4px;color: #fff;padding: 8px 16px;display: inline-block;font-weight: 400;text-align: center;white-space: nowrap;vertical-align: middle;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;border: 1px solid transparent;font-size: 1rem;line-height: 1.5;-webkit-transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;}input[type=submit]::-moz-focus-inner, input[type=reset]::-moz-focus-inner, input[type=button]::-moz-focus-inner, button::-moz-focus-inner {padding: 0;}input[type=submit]:hover, input[type=reset]:hover, input[type=button]:hover, button:hover {background-color: #0069d9;border-color: #0062cc;color: #fff;}input[type=submit]:not(:disabled):active, input[type=reset]:not(:disabled):active, input[type=button]:not(:disabled):active, button:not(:disabled):active {background-color: #0062cc;border-color: #005cbf;color: #fff;}input[type=submit]:focus, input[type=reset]:focus, input[type=button]:focus, button:focus {outline: 0;-webkit-box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.5);}input[type=submit]:disabled, input[type=reset]:disabled, input[type=button]:disabled, button:disabled {opacity: .65;cursor: not-allowed;background-color: #75cc00;border-color: #75cc00;color: #fff;}table {border-top: 1px solid rgba(0, 0, 0, 0.12);margin-bottom: 16px;}caption {padding: 8px 0;}thead th {border: 0;border-bottom: 2px solid rgba(0, 0, 0, 0.12);text-align: left;}tr {margin-bottom: 8px;}th, td {border-bottom: 1px solid rgba(0, 0, 0, 0.12);padding: 16px;white-space: nowrap;vertical-align: inherit;}tfoot tr {text-align: left;}tfoot td {color: rgba(0, 0, 0, 0.54);font-size: 8px;font-style: italic;padding: 16px 4px;}a.skip-main {left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-999;}a.skip-main:focus, a.skip-main:active {color: #fff;background-color:#000;left: auto;top: auto;width: 30%;height: auto;overflow:auto;margin: 10px 35%;padding:5px;border-radius: 15px;border:4px solid yellow;text-align:center;font-size:1.2em;z-index:999;}@font-face {font-family: 'Raleway';font-style: normal;font-weight: 600;src: url('/s/inc/css/raleway-v18-latin-600.eot');src: local(''), url('/s/inc/css/raleway-v18-latin-600.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/raleway-v18-latin-600.woff2') format('woff2'), url('/s/inc/css/raleway-v18-latin-600.woff') format('woff'), url('/s/inc/css/raleway-v18-latin-600.ttf') format('truetype'), url('/s/inc/css/raleway-v18-latin-600.svg#Raleway') format('svg');}@font-face {font-family: 'Raleway';font-style: italic;font-weight: 400;src: url('/s/inc/css/raleway-v18-latin-italic.eot');src: local(''), url('/s/inc/css/raleway-v18-latin-italic.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/raleway-v18-latin-italic.woff2') format('woff2'), url('/s/inc/css/raleway-v18-latin-italic.woff') format('woff'), url('/s/inc/css/raleway-v18-latin-italic.ttf') format('truetype'), url('/s/inc/css/raleway-v18-latin-italic.svg#Raleway') format('svg');}@font-face {font-family: 'Roboto Mono';font-style: normal;font-weight: 400;src: url('/s/inc/css/roboto-mono-v12-latin-regular.eot');src: local(''), url('/s/inc/css/roboto-mono-v12-latin-regular.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/roboto-mono-v12-latin-regular.woff2') format('woff2'), url('/s/inc/css/roboto-mono-v12-latin-regular.woff') format('woff'), url('/s/inc/css/roboto-mono-v12-latin-regular.ttf') format('truetype'), url('/s/inc/css/roboto-mono-v12-latin-regular.svg#RobotoMono') format('svg');}@font-face {font-family: 'Roboto Mono';font-style: normal;font-weight: 600;src: url('/s/inc/css/roboto-mono-v12-latin-600.eot');src: local(''), url('/s/inc/css/roboto-mono-v12-latin-600.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/roboto-mono-v12-latin-600.woff2') format('woff2'), url('/s/inc/css/roboto-mono-v12-latin-600.woff') format('woff'), url('/s/inc/css/roboto-mono-v12-latin-600.ttf') format('truetype'), url('/s/inc/css/roboto-mono-v12-latin-600.svg#RobotoMono') format('svg');}@font-face {font-family: 'Ubuntu';font-style: normal;font-weight: 400;src: url('/s/inc/css/ubuntu-v15-latin-regular.eot');src: local(''), url('/s/inc/css/ubuntu-v15-latin-regular.eot?#iefix') format('embedded-opentype'), url('/s/inc/css/ubuntu-v15-latin-regular.woff2') format('woff2'), url('/s/inc/css/ubuntu-v15-latin-regular.woff') format('woff'), url('/s/inc/css/ubuntu-v15-latin-regular.ttf') format('truetype'), url('/s/inc/css/ubuntu-v15-latin-regular.svg#Ubuntu') format('svg');}@font-face {font-family:'Raleway2';font-style:normal;font-weight:normal;src:url('/s/inc/css/raleway.eot');src:local('Raleway2'),local('Raleway2'),url('/s/inc/css/raleway.ttf') }.headheader {font-family:"Raleway2"!important }.headheader a {color:#000;text-decoration:none }.headheader a:hover {color:#000;text-decoration:none!important }#toc ul {list-style: none;margin: 0;padding: 0;}#toc h3 {color:black;}</style>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org 
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAKCAYAAAD2Fg1xAAABgElEQVQ4jb3VP0iVYRTH8c9waXBokog7OYhTXChuF3GIi4hoiJA4REQIOTgGtoWTg6ODs0SYComIXCJEMhpKtD9guUU0ujRFS0PQ8DzC24v3Pq+3S9/pnMOP8/7Ocx6el/OziRN0JXTD+I2xhK4WdeNteGmbu8IgC3jQQlfCZ0zgINHzJabwoQP+ClHGV1zGJXwRDJ/FDJZi3MBQE10dL2K8gZFOGE3REDZyyjLunKG7KAzZHfMaXjXp+QbXYlzBfrvmSuhBNaHrxQU8zdQW8RhrOe0snuB7zA/jd6p4n9HV8QMfY/4JPzGAt7meFfS18LdXEk7uemIQuJ/Lj6PZQezFWhm3cTWnXcAj3MrU5oWh5WpzGM3UurGNZy28HSa8J7mB3Uy+4u/rl+UdrsT4Jraa6F6jP5M3MP0PHguzL9zzqmC2GRNYjXF2qDzDwgbgHp53wGMhJrEunGQ9oT3CQ+GFasWBsLVvwiv5XygJz/JOAe208POrJHST+CVspBB/AFY9Q3+QJqLxAAAAAElFTkSuQmCC" alt="Raymii.org Logo">
                    </a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          
    <h2 class='headheader' id='main'>The yearly backup restore test</h2>
<p><small>Published: 05-11-2021 | Author: Remy van Elst | <a href="Yearly_Backup_Restore_test.txt">Text only version of this article</a>
</small></p>
<div class='ad'>
                                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7993642564731324"
                             crossorigin="anonymous"></script>
                        <!-- voorartikel -->
                        <ins class="adsbygoogle"
                             style="display:block"
                             data-ad-client="ca-pub-7993642564731324"
                             data-ad-slot="6172324376"
                             data-ad-format="auto"></ins>
                        <script>
                             (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                        </div><br><div class='olderthanayear'><p><strong>&#10071; This post is over one year old. It may no longer be up to date. Opinions may have changed.</strong></p></div>
<div id="toc">
<h3>Table of Contents</h3>
<ul>
<li>
<a href="#toc_0">An untested backup is worthless</a>
</li>
<li>
<a href="#toc_1">Backup procedures</a>
</li>
<li>
<a href="#toc_2">Restore process and data validation</a>
</li>
<li>
<a href="#toc_3">Restore duration</a>
</li>
<li>
<a href="#toc_4">Cost?</a>
</li>
<li>
<a href="#toc_5">Summary</a>
</li>
</ul>

</div><hr><div id="contents">
<p>In my calendar there is a yearly recurring item named &#39;backup restore test&#39;. This is an article on my backup scheme and the yearly restore test, covering all aspects, such as data validation, backup scheme, time and cost involved.
I started doing personal restore tests each year around 2012, when I did them for my first job. At work back then, the restore test was monthly, for my own backups I decided that yearly was okay enough, since the backup scheme, software and provider do not change. I&#39;m using Azure cold storage for my (locally encrypted) personal backups, since it&#39;s both cheap and supported by my local NAS.</p>

<p>Have you done your backup restore test recently?</p>

<p>An untested / unverified backup is the same as no backup, so doing a restore
test is a major part in your backup scheme.</p>

<p>I started doing personal restore tests each year around 2012, when I did them
for my first job. At work back then, the restore test was monthly, for my own
backups I decided that yearly was okay enough, since the backup scheme,
software and provider do not change. I&#39;m using Azure cold storage for my
(locally encrypted) personal backups, since it&#39;s both cheap and supported by
my local NAS.</p>

<p class="ad"> <a href="https://leafnode.nl">I'm developing an open source monitoring app called  Leaf Node Monitoring, for windows, linux & android. Go check it out!</a><br><br> <a href="https://github.com/sponsors/RaymiiOrg/">Consider sponsoring me on Github. It means the world to me if you show your appreciation and you'll help pay the server costs.</a><br><br> <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">You can also sponsor me by getting a Digital Ocean VPS. With this referral link you'll get $100 credit for 60 days. </a><br><br> </p>

<p>The backup restore test involves a NAS device, Azure Blob storage and 
<a href="http://md5deep.sourceforge.net/">md5deep</a> to verify file integrity afterwards and compare it with
a known list of hashes I made before restoring.</p>

<p>I recommend you do a restore test at least once a year. If your restore
test happens when you actually need a restore, it&#39;s probably too late.</p>

<h3 id="toc_0">An untested backup is worthless</h3>

<p>There is an older sysadmin wisdom regarding backups, called the 
<a href="https://web.archive.org/web/20210831004934/https://www.veeam.com/blog/321-backup-rule.html">3-2-1 backups scheme</a>:</p>

<ul>
<li>There should be 3 copies of data</li>
<li>On 2 different media</li>
<li>With 1 copy being off site</li>
</ul>

<p>I&#39;m not saying that is a perfect scheme, but I do prefer
offline long-term backups, like on tape drives or external
disks, not connected to the network. </p>

<p>All backup schemes and procedures do have one thing in common,
<strong>an untested backup is the same as no backup.</strong></p>

<p>I&#39;m probably never going to get hit by ransomware, but if you&#39;re responsible
for a corporate IT environment, you better know how to restore data and how
long it takes to get up and running when all data is gone. </p>

<p>My yearly restore test involves a full restore, assuming all data was lost
locally. In this fictional scenario I go to the store, buy a NAS device and
enter the credentials of the storage, then restore the entire data set.
Skipping the NAS-buying part, that would be costly each year.</p>

<p>Keep in mind that this article covers a home setup, not a corporate one. </p>

<h3 id="toc_1">Backup procedures</h3>

<p>All local devices are configured to backup their data to the NAS. The exact
method differs per device, some use rsync, some use ssh, some use a bunch of
scripts and some even only have an NFS share. The data backed up also
differs, from full copies of my daily drivers (laptop/workstation) with
Duplicity, a Time Machine storage backend, a Veeam storage repository to a
sync of all my photo&#39;s and calendars. All important data is backed up or synced
at least once every 24 hours.</p>

<p>The NAS uses a vendor provided program to backup to a cloud provider, a whole 
bunch are supported but I went with Azure as their pricing is the cheapest 
for my use case. I tried a few different providers, S3 was way to expensive
and a few local (Dutch) providers also could not match up with Azure&#39;s pricing.</p>

<p>The NAS backups are encrypted (with GPG) and it keeps historical versions of
data. I also plug in a USB disk once a month, sync it up (also encrypted) and
store that in a different location, offline. If the whole city burns down
or is hit by (insert favorite disaster here) and Azure is offline, I should still
be able to restore my data, hopefully. </p>

<h3 id="toc_2">Restore process and data validation</h3>

<p>The restore test uses the NAS vendor restore application to restore the entire 
most recent data set of the backup to a different folder. I can do that because 
I have enough free space. Once this NAS is up for renewal I can try to do a 
restore to a new device, that would be fun. At work we have a separate spare
storage chassis and controller to do restores if the main units ever were to 
fail and we cannot buy the same model or newer in the model series again.</p>

<p>After the data download and restore completed I verified file integrity using
a simple but fast tool named <a href="http://md5deep.sourceforge.net/">md5deep</a>. It hashes all files recursively, 
here&#39;s some example output:</p>

<pre><code>$ md5deep -r qt*
b35e0aabb4916f55638d0870737c3006  /home/remy/Downloads/qt-license.txt
df3357a2043c6a03e8cb43f8f630c5a0  /home/remy/Downloads/qt-vnc-1.png
0c8449193fcfe45f7ccbd9877597b2a0  /home/remy/Downloads/qt-license-creator.txt
d967941393d3eee140bac618c4f5a9e3  /home/remy/Downloads/qtdd13_practical_qml.pdf
59b2ba8cb810bab4b762efaf61b73cf2  /home/remy/Downloads/qt-creator-enterprise-linux-x86_64-5.0.2.run
6e593290035170c3b2a37782e1b4e525  /home/remy/Downloads/qt-creator-enterprise-windows-x86_64-5.0.2.exe
9cf75d81ef30d3eebb463cf19dfb5893  /home/remy/Downloads/qt-everywhere-src-5.15.6.tar.xz
4d6dcb1a7acb32a885e761d85e3cc7f8  /home/remy/Downloads/qt-enterprise-linux-x64-5.15.6.run
c06d944dd270952aa11218fcd0a4d9ae  /home/remy/Downloads/qt-enterprise-windows-x86-5.15.6.exe
</code></pre>

<p>Before doing the restore I made the same list, after a simple <code>diff</code> I know
that there were no (obvious) errors. A cron job runs on the NAS to make this
list every week, a diff is emailed to me so I know whenever files get 
corrupted. Has that happen twice in all those years, so this detection does work,
even though it uses MD5. I choose to use MD5 because the NAS device is slow, 
other algorithms are available (via <code>hashdeep</code>) but they do take way longer 
for the amount of files I have.</p>

<p>If the NAS device would be more powerful, I would use ZFS, since that has
very well data corruption prevention. All of my workstations use ZFS, so
there the data is protected against corruption. For this low-spec NAS device
this is a simple solution which has proven to be reliable enough. </p>

<h3 id="toc_3">Restore duration</h3>

<p>My home internet is a fiber to the home (FTTH) connection with 50 Mbps up and
50 Mbps down, I&#39;m using a modified version of <a href="https://web.archive.org/web/20211102151602/https://www.jeffgeerling.com/blog/2021/setting-pi-remote-internet-connection-monitoring">Jeff Geerlings remote
connection monitoring dashboard</a> which shows that I most often not get the
full speed, the average is about 40 Mbps up and 34 Mbps down. Not much of a
problem, fast enough for a reasonable price (EUR 26/month).</p>

<p>The restore on the NAS took <strong>5 days, 18 hours and 16 minutes.</strong> The amount of
data transferred according to <a href="/s/inc/img/azure-egress.png">Azure</a> was <strong>1.7 TB</strong>, so that gives an average
of 29 Mbps or 3.62 MBps. When using a <a href="https://www.azurespeed.com/Azure/Download">speed test download</a> from the West
Europe Azure region, on the device (which is directly plugged in to the managed
switch to the router), I also average around 3 to 3.5 MBps. On another, more
powerful device, same cable, I average up to 4.21 MBps, so it all evens out
around 30 Mbps. The North Europe region averages out the same in speed tests.</p>

<p>The NAS device is not that powerful (ARM cpu and 512 MB of RAM) but has low
energy usage, which for me was a more important factor than speed, since all
it does is handle local backups and serve some files out over NFS or SMB. </p>

<p>The average speed monitored and the backup restore speed are about the same,
so I did expect it to take a while when I started. Last years restore test 
involved the USB drive and the year before that the data usage was way less
than this year, so those numbers were not really representative.</p>

<h3 id="toc_4">Cost?</h3>

<p>I&#39;m using an Azure Blob Storage account, like Amazon S3 or OpenStack Swift for
storing the backups. I&#39;m using the <a href="https://web.archive.org/web/20211020075333/https://docs.microsoft.com/en-us/azure/storage/blobs/access-tiers-overview">Cool tier</a>, that is optimized for
storing data that is infrequently accessed or modified. Data in the Cool tier
should be stored for a minimum of 30 days. The cool tier has lower storage
costs and higher access costs compared to the hot tier.</p>

<p>The cost of object storage is always hard to calculate up front. You can get
an educated guess, but usage patterns always change or are different and the
operations you do are not always the same among cloud providers. This
paragraph serves as an indication.</p>

<p>The total backup size varies between 2 and 3 TB, but most of the time it&#39;s
about 2.5 TB, at the time of the restore test it was 2.68 TB. I&#39;m keeping a
bit of history, the NAS manages that for me. The actual used storage on disk
is about 1.8 TB, and I can go back 30 file versions or about 5 weeks. The
usual change in data is <a href="/s/inc/img/azure-ingress.png">about 20 GB</a>.</p>

<p>The actual restore amount traffic in <a href="/s/inc/img/azure-egress.png">Azure was 1.7 TB</a>, which matches the
current used traffic.</p>

<p>Azure offers quite an extensive log of what usage cost you&#39;ve made, also an
overview of invoices.</p>

<p>The average regular backup cost for the past year is EUR 24. Lasts month
invoice was EUR 25.93. This restore action made this months invoice increase
to EUR 37.88. </p>

<p>Looking into <a href="/s/inc/img/azure-cost.png">the detailed usage CSV</a> for last month and this month, I can see
exactly where this increase comes from. Meter <code>Cool Data Retrieval</code> last
month was at max EUR 0.015691, this month I have 5 rows with a price around
EUR 2.50, which totals to EUR 10.97. Last month&#39;s total <code>Cool Data Retrieval</code>
was EUR 0.10, this month it&#39;s EUR 11.06. The other meters did not increase
significantly.</p>

<h3 id="toc_5">Summary</h3>

<p>Summarizing, the restore test cost on Azure Cool Blob Storage were about EUR
11 for about 1.7 TB of data. The time it took for the full restore was 5 days
and 18 hours and all files were checked for corruption. </p>

<p>I&#39;m deliberately vague on the specific NAS device because I don&#39;t want to
endorse one specific device or brand. I want an energy-efficient device
with low usage because it&#39;s on 24/7. You might want a big powerful device
to stream and re-encode your entire media library, or you want to fiddle around
with some BSD based NAS software. If you read this site, you&#39;re probably enough
of a nerd to figure out what is a great fit for you in terms of NAS devices.</p>

<p>Now go plan your backup restore test! </p>
Tags: <a href="../tags/azure.html">azure</a>
, <a href="../tags/backup.html">backup</a>
, <a href="../tags/blog.html">blog</a>
, <a href="../tags/cloud.html">cloud</a>
, <a href="../tags/gpg.html">gpg</a>
, <a href="../tags/nas.html">nas</a>
, <a href="../tags/nfs.html">nfs</a>
, <a href="../tags/restore.html">restore</a>
, <a href="../tags/rsync.html">rsync</a>
, <a href="../tags/s3.html">s3</a>
, <a href="../tags/sysadmin.html">sysadmin</a>
</div>
<br/>
<footer>
<br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p><small>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a>.</small>
                </p>
    
    </footer>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-3704876-6');
    </script>
    <script data-goatcounter="https://raymii.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
     
    </main>
    </body>
    </html>
    